(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    107395,       2227]
NotebookOptionsPosition[     97973,       2098]
NotebookOutlinePosition[     98571,       2118]
CellTagsIndexPosition[     98528,       2115]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Piece of Cake coordinates Jacobian code generation", "Title",
 CellChangeTimes->{{3.842480859572761*^9, 3.8424808734034557`*^9}, {
  3.842742869283586*^9, 3.842742878013317*^9}, {3.843003248017685*^9, 
  3.843003253996933*^9}, {3.843838607912539*^9, 3.8438386131860456`*^9}, {
  3.8692317274362097`*^9, 3.86923173082513*^9}, {3.869232009919592*^9, 
  3.869232010579658*^9}},ExpressionUUID->"06cf51ac-2049-45e5-befb-\
5e7a3ea14fb4"],

Cell[CellGroupData[{

Cell["Formating", "Section",
 CellChangeTimes->{{3.967573361840172*^9, 
  3.967573362928553*^9}},ExpressionUUID->"c6457ca3-1714-4873-8939-\
acf5ec5341ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"Power", ",", "Sqrt"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"HoldForm", "[", 
    RowBox[{"(", 
     RowBox[{"1", "/", "a"}], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"pow", "[", 
     RowBox[{"a", ",", "b"}], "]"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Sqrt", "[", "a_", "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"sqrt", "[", "a", "]"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"Power", ",", "Sqrt"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.955990589892071*^9, 3.9559905981056223`*^9}, {
  3.955990628109312*^9, 3.9559906340540247`*^9}, {3.955991016709017*^9, 
  3.955991019506207*^9}, {3.956159811459832*^9, 3.956159847792693*^9}, {
  3.959434780679373*^9, 3.959434806599037*^9}, {3.9599626012786007`*^9, 
  3.9599626090448523`*^9}, {3.959962643361821*^9, 3.9599626639250507`*^9}, {
  3.9599629286676292`*^9, 3.9599629349206257`*^9}, {3.96151846297223*^9, 
  3.961518463702381*^9}, {3.96151894170547*^9, 3.961518969258565*^9}, {
  3.9615189993913116`*^9, 3.961519005138625*^9}, {3.967573380981393*^9, 
  3.967573444498766*^9}, {3.9675748457260637`*^9, 3.967574853760634*^9}, {
  3.9675749118131933`*^9, 3.967574913150407*^9}, {3.967574986927252*^9, 
  3.967574990241864*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"f9245ca4-e8e9-41b0-ba49-02ff0b656537"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Patch system ", "Section",
 CellChangeTimes->{{3.8448108646711617`*^9, 3.844810871321*^9}, {
  3.845641104146451*^9, 3.845641105656435*^9}, {3.8456414906301517`*^9, 
  3.845641495240016*^9}, {3.845641576798369*^9, 3.845641578368043*^9}, {
  3.922450748171774*^9, 
  3.922450748500943*^9}},ExpressionUUID->"4433c9f4-e92e-44f9-a920-\
9fcf114e462f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Import", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], 
    "<>", "\"\<cubed_sphere_07.mx\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.922450751043352*^9, 3.922450774200289*^9}, {
  3.967573160644453*^9, 3.967573160863604*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"e02718e7-d42d-49ab-aad7-206b2a63f45a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Local to global", "Section",
 CellChangeTimes->{{3.967573169535993*^9, 3.967573172701343*^9}, {
  3.967573211725782*^9, 
  3.9675732151095133`*^9}},ExpressionUUID->"c15fe3d2-3cf8-46ee-8721-\
be7399087296"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::cartesian:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"cart", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"cart", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"cart", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::plus_x:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"px", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"px", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"px", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::plus_y:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"py", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"py", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"py", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::minus_x:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"mx", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"mx", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"mx", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::minus_y:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"my", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"my", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"my", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::plus_z:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"pz", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"pz", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"pz", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::minus_z:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"mz", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"mz", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"mz", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.967573512212557*^9, 3.967573516165152*^9}, {
  3.967573581881*^9, 3.967573588715043*^9}, {3.967573734788217*^9, 
  3.967573734962173*^9}, {3.967573772497283*^9, 3.967573833008089*^9}, {
  3.967573903439476*^9, 3.967573905740672*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"45564e3e-4a33-437b-ad14-76faf69b5efd"],

Cell[CellGroupData[{

Cell[BoxData["\<\"case PatchPiece::cartesian:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"5ccf2f96-0242-4325-85f5-8255f324c9c5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"a\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["global_coords(0) = ", "a", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.97307957263515*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"7ebe74de-fccd-4404-acf9-0fd7dc1c6f46"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"b\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["global_coords(1) = ", "b", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572635934*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"2d353629-b01d-44ef-b633-91fa23914be1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(2) = \"\>", "\[InvisibleSpace]", "\<\"c\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["global_coords(2) = ", "c", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572636183*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"b60e45f5-250c-47ee-8a2a-14aa88770f72"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572636409*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"0b3ef6f8-6602-4321-a6c0-5e60462346b9"],

Cell[BoxData["\<\"case PatchPiece::plus_x:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572636611*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"94301008-ef44-41f7-b2ca-a5dc5c132b53"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(0) = \"\>", 
   "\[InvisibleSpace]", "\<\"(r0 - c*r0 + r1 + c*r1)/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(0) = ", 
   "(r0 - c*r0 + r1 + c*r1)/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + pow(b,2)*(1 \
+ c)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.9730795726368217`*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"065d2162-f27e-4d5f-9aa3-ca70639f7f82"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(1) = \"\>", 
   "\[InvisibleSpace]", "\<\"(b*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(1) = ", 
   "(b*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.9730795726370897`*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"a4e500f7-2570-4505-9157-366af616f89c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(a*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(2) = ", 
   "(a*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572637347*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"c499bd5e-777f-4eca-8846-3036eddb8b4a"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572637596*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"d5c5df34-5bba-4b9e-9ed2-0e08c53f4450"],

Cell[BoxData["\<\"case PatchPiece::plus_y:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.9730795726377907`*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"e0dd2fdb-b0dd-433d-9a53-ba19051c01e9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(0) = \"\>", 
   "\[InvisibleSpace]", "\<\"-((b*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c))))\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(0) = ", 
   "-((b*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c))))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.9730795726379957`*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"08391fff-42e8-4437-ab32-0887680648a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(1) = \"\>", 
   "\[InvisibleSpace]", "\<\"(r0 - c*r0 + r1 + c*r1)/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(1) = ", 
   "(r0 - c*r0 + r1 + c*r1)/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + pow(b,2)*(1 \
+ c)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572638259*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"fe08c82d-d3b1-435b-8d2b-5ac0428a69db"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(a*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(2) = ", 
   "(a*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572638505*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"49a9a2d8-85d5-48b1-a203-057eb38fc862"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572638747*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"0e8bd256-a756-474a-befb-3085c42e2301"],

Cell[BoxData["\<\"case PatchPiece::minus_x:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.9730795726389427`*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"a79b7cdd-da7d-4faa-866b-31ea13135a25"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(0) = \"\>", 
   "\[InvisibleSpace]", "\<\"-((r0 - c*r0 + r1 + c*r1)/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c))))\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(0) = ", 
   "-((r0 - c*r0 + r1 + c*r1)/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c))))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.9730795726391582`*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"bf4b0162-3c54-4bdb-93d8-41ad204b1c6f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(1) = \"\>", 
   "\[InvisibleSpace]", "\<\"-((b*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c))))\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(1) = ", 
   "-((b*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c))))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572639411*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"c53634a3-0678-46cc-b356-89a63c7ae766"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(a*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(2) = ", 
   "(a*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.9730795726396637`*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"99940e6e-effd-4bb9-8747-47636cae9355"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572639902*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"53cc3413-fb87-4c5f-8675-4b91174ddec0"],

Cell[BoxData["\<\"case PatchPiece::minus_y:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572640099*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"13acffb3-6750-4131-9644-2ca1cb5357f7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(0) = \"\>", 
   "\[InvisibleSpace]", "\<\"(b*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(0) = ", 
   "(b*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572640312*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"e111d791-4df6-4cc7-af54-5cfc0d3e6e11"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(1) = \"\>", 
   "\[InvisibleSpace]", "\<\"-((r0 - c*r0 + r1 + c*r1)/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c))))\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(1) = ", 
   "-((r0 - c*r0 + r1 + c*r1)/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c))))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572640571*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"b3b7af8d-541f-4a61-8c93-0f1ecc4863dd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(a*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(2) = ", 
   "(a*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572640821*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"3f44bf42-77ee-455f-a1c9-83e47f3eccfe"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572641075*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"c660d4ab-224d-49b6-bb99-5c37cf3c3e7c"],

Cell[BoxData["\<\"case PatchPiece::plus_z:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.9730795726412697`*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"f53083d1-3dfc-418b-bbf0-69c5e4e52d13"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(0) = \"\>", 
   "\[InvisibleSpace]", "\<\"-((a*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c))))\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(0) = ", 
   "-((a*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c))))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.9730795726414833`*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"3acf4858-57ab-455e-93b9-3b604bded84b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(1) = \"\>", 
   "\[InvisibleSpace]", "\<\"(b*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(1) = ", 
   "(b*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572641747*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"ce634ea6-5898-4daa-85d8-4d270c950841"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(r0 - c*r0 + r1 + c*r1)/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(2) = ", 
   "(r0 - c*r0 + r1 + c*r1)/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + pow(b,2)*(1 \
+ c)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572642009*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"5c417754-1e1b-4c3f-8800-28c97bae0f71"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572642262*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"171bd416-a91a-4f80-a7de-859fa913d47c"],

Cell[BoxData["\<\"case PatchPiece::minus_z:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.9730795726424627`*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"3cb63f62-e269-4b76-8944-26a5c9acaa28"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(0) = \"\>", 
   "\[InvisibleSpace]", "\<\"(a*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(0) = ", 
   "(a*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.9730795726426907`*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"8cf269e0-f108-4692-89af-0bcf4b16335f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(1) = \"\>", 
   "\[InvisibleSpace]", "\<\"(b*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(1) = ", 
   "(b*(r0 - c*r0 + r1 + c*r1))/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.97307957264297*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"d76e8907-1a76-407e-b57f-5fd8610a575f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"-((r0 - c*r0 + r1 + c*r1)/(sqrt(2)*sqrt(2 + \
pow(a,2)*(1 + c) + pow(b,2)*(1 + c))))\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(2) = ", 
   "-((r0 - c*r0 + r1 + c*r1)/(sqrt(2)*sqrt(2 + pow(a,2)*(1 + c) + \
pow(b,2)*(1 + c))))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572643227*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"95e61c0b-e99c-4983-9aee-2382f75c2299"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572643466*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"1c2dd392-c1e2-4de4-b8bb-077c0b54c9d4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Global to local", "Section",
 CellChangeTimes->{{3.967573169535993*^9, 3.967573172701343*^9}, {
  3.967573211725782*^9, 3.9675732151095133`*^9}, {3.967573970285174*^9, 
  3.967573978071368*^9}},ExpressionUUID->"fe49fa3d-90d5-4db5-99a9-\
4384ecdef012"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::cartesian:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Icart", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Icart", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Icart", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::plus_x:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipx", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipx", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipx", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::plus_y:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipy", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipy", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipy", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::minus_x:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imx", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imx", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imx", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::minus_y:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imy", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imy", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imy", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::plus_z:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipz", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipz", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipz", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::minus_z:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imz", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imz", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imz", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.967573512212557*^9, 3.967573516165152*^9}, {
  3.967573581881*^9, 3.967573588715043*^9}, {3.967573734788217*^9, 
  3.967573734962173*^9}, {3.967573772497283*^9, 3.967573833008089*^9}, {
  3.967573903439476*^9, 3.967573905740672*^9}, {3.967573985846487*^9, 
  3.96757404331992*^9}, {3.9675741172867126`*^9, 3.9675741634914207`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"773c85fb-2342-4844-9b40-46ebe84a1bb4"],

Cell[CellGroupData[{

Cell[BoxData["\<\"case PatchPiece::cartesian:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"0276016e-ac2c-4cc2-9394-3b6b041e9896"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"x\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(0) = ", "x", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572675914*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"e789d19b-2117-40f4-bb51-cc0023c52df2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"y\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(1) = ", "y", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572676326*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"09da0896-1f1a-47a3-9228-160d7897dd89"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(2) = \"\>", "\[InvisibleSpace]", "\<\"z\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(2) = ", "z", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572676557*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"40bed0f9-e7ca-4026-85f2-5fcdb00cee87"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572676773*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"c440ee56-6767-402e-8001-3d0717106294"],

Cell[BoxData["\<\"case PatchPiece::plus_x:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572676969*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"e2a805d0-63ee-41c8-9d78-d827e5a44756"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"z/x\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(0) = ", "z/x", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572677177*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"b5410e1d-e66b-4710-8b68-1d81da5684c2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"y/x\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(1) = ", "y/x", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572677392*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"ba8e42a2-342c-453e-b3b0-de79252dfc09"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(pow(r0,2) - pow(r1,2) + pow(y,2) + pow(z,2) + \
sqrt(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2))))/pow(r0 - r1,2)\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "local_coords(2) = ", 
   "(pow(r0,2) - pow(r1,2) + pow(y,2) + pow(z,2) + sqrt(4*pow(r1,2)*pow(x,2) \
+ pow(pow(y,2) + pow(z,2),2) + 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - \
4*r0*r1*(2*pow(x,2) + pow(y,2) + pow(z,2))))/pow(r0 - r1,2)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572677601*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"5ede6e5e-1918-4e41-998e-ed8719cd503b"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572677911*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"17ff56cd-2637-4b69-9bfa-976daf469c00"],

Cell[BoxData["\<\"case PatchPiece::plus_y:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572678117*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"44893ec3-ad15-48dc-bef0-c4d964056077"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"z/y\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(0) = ", "z/y", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572678329*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"fb7ff948-cd28-45d4-896d-b7a120d827d6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"-(x/y)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(1) = ", "-(x/y)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.97307957267855*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"50e27581-b72d-4695-9eb7-6a874c4efe8d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(pow(r0,2) - pow(r1,2) + pow(x,2) + pow(z,2) + \
sqrt(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2))))/pow(r0 - r1,2)\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "local_coords(2) = ", 
   "(pow(r0,2) - pow(r1,2) + pow(x,2) + pow(z,2) + sqrt(4*pow(r1,2)*pow(y,2) \
+ pow(pow(x,2) + pow(z,2),2) + 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - \
4*r0*r1*(pow(x,2) + 2*pow(y,2) + pow(z,2))))/pow(r0 - r1,2)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726787653`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"765f83be-8107-4bdb-ae56-fecdb40922ba"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726790667`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"a24ff2e6-cc24-490e-af88-2bf1c719ce0e"],

Cell[BoxData["\<\"case PatchPiece::minus_x:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726792727`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"aa3bdf61-3790-4f4a-afdb-fa95d0be57da"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"-(z/x)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(0) = ", "-(z/x)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572679476*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"ceb8bbd5-83f7-461f-b299-32e432a54a5c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"y/x\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(1) = ", "y/x", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726797*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"70426655-f752-44cc-a021-6191cd129d62"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(pow(r0,2) - pow(r1,2) + pow(y,2) + pow(z,2) + \
sqrt(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2))))/pow(r0 - r1,2)\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "local_coords(2) = ", 
   "(pow(r0,2) - pow(r1,2) + pow(y,2) + pow(z,2) + sqrt(4*pow(r1,2)*pow(x,2) \
+ pow(pow(y,2) + pow(z,2),2) + 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - \
4*r0*r1*(2*pow(x,2) + pow(y,2) + pow(z,2))))/pow(r0 - r1,2)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572679914*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"22fb0033-2fba-4a78-a1fb-3b04a434fbb3"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572680217*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"3ffcf74e-7e37-47a5-9d09-f608d1af0e76"],

Cell[BoxData["\<\"case PatchPiece::minus_y:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572680427*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"fe062614-1bd2-415c-8f8d-e4230d9b6a66"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"-(z/y)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(0) = ", "-(z/y)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572680634*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"879c59ad-ad5b-4919-8d91-d75489a749ee"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"-(x/y)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(1) = ", "-(x/y)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572680855*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"712c84a9-fde1-499a-8680-1474e08eb0bb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(pow(r0,2) - pow(r1,2) + pow(x,2) + pow(z,2) + \
sqrt(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2))))/pow(r0 - r1,2)\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "local_coords(2) = ", 
   "(pow(r0,2) - pow(r1,2) + pow(x,2) + pow(z,2) + sqrt(4*pow(r1,2)*pow(y,2) \
+ pow(pow(x,2) + pow(z,2),2) + 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - \
4*r0*r1*(pow(x,2) + 2*pow(y,2) + pow(z,2))))/pow(r0 - r1,2)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572681076*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"7d514b6d-8f71-4732-a24e-83fd466362e9"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726813707`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"d0812132-cece-4969-8c9d-63d489965ad0"],

Cell[BoxData["\<\"case PatchPiece::plus_z:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726815643`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"f5901f42-d247-4edf-8bfc-9c597ea68c19"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"-(x/z)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(0) = ", "-(x/z)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726817913`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"6d9a6af7-1092-4a8d-9616-9861fc027473"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"y/z\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(1) = ", "y/z", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726820107`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"f72caa0b-6d7b-400a-aafb-3bb4ae998e55"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(pow(r0,2) - pow(r1,2) + pow(x,2) + pow(y,2) + \
sqrt((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 \
- r1,2)*pow(z,2)))/pow(r0 - r1,2)\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "local_coords(2) = ", 
   "(pow(r0,2) - pow(r1,2) + pow(x,2) + pow(y,2) + sqrt((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2)))/pow(r0 - r1,2)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726822453`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"1c0dc1bb-a30e-48f3-885e-31f8dc463cc5"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726825314`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"ae371bb4-b434-42c5-a403-685f029bb82c"],

Cell[BoxData["\<\"case PatchPiece::minus_z:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726827297`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"4a2cbd26-001c-4a44-89d4-3389d31b04fd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"-(x/z)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(0) = ", "-(x/z)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726829348`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"14054735-e1a8-4267-89c2-cf993f7dfef1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"-(y/z)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(1) = ", "-(y/z)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726831636`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"8beb5503-7156-40e1-bfe8-54bbc0f73c7d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(pow(r0,2) - pow(r1,2) + pow(x,2) + pow(y,2) + \
sqrt((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 \
- r1,2)*pow(z,2)))/pow(r0 - r1,2)\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "local_coords(2) = ", 
   "(pow(r0,2) - pow(r1,2) + pow(x,2) + pow(y,2) + sqrt((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2)))/pow(r0 - r1,2)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.973079572683407*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"a6308fe0-519c-4377-a621-9976b965c396"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726836863`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"b75c627f-d257-4599-8cda-872f0d3bb7f8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jacobians and Jacobian Derivatives", "Section",
 CellChangeTimes->{{3.85807029256612*^9, 3.85807030329497*^9}, 
   3.869242415762504*^9, {3.869242688777238*^9, 3.8692426889874*^9}, {
   3.922450895732071*^9, 
   3.922450903911428*^9}},ExpressionUUID->"d9a6ec80-94ff-4010-a85e-\
5a76d9141abd"],

Cell[TextData[{
 "CarpetX defines\n\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"J", "[", "i", "]"}], "[", "j", "]"}], "=", 
    FractionBox[
     SuperscriptBox["da", "i"], 
     SuperscriptBox["dx", "j"]]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"dJ", "[", "i", "]"}], "[", "j", "]"}], "[", "k", "]"}], "=", 
    RowBox[{
     FractionBox["d", 
      SuperscriptBox["dx", "k"]], 
     RowBox[{"(", 
      FractionBox[
       SuperscriptBox["da", "i"], 
       SuperscriptBox["dx", "j"]], ")"}]}]}], TraditionalForm]}],
  ExpressionUUID->"e916b45b-0691-43bb-b104-b99c3792f970"]
}], "Text",
 CellChangeTimes->{{3.8460843424597054`*^9, 3.846084494466394*^9}, {
  3.857120063429269*^9, 3.857120086484022*^9}, {3.857132591638426*^9, 
  3.857132592022197*^9}, {3.8580687165349627`*^9, 3.858068867341958*^9}, {
  3.858069271864131*^9, 3.858069323613624*^9}, {3.858069425391279*^9, 
  3.85806947653013*^9}, {3.8580702263171883`*^9, 3.858070287806102*^9}, {
  3.9224508684843073`*^9, 3.922450890707775*^9}, {3.922451119536634*^9, 
  3.922451120040235*^9}, {3.973079549952407*^9, 
  3.97307955088708*^9}},ExpressionUUID->"a1dc3eef-aba1-46f5-8810-\
b875ef843746"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateJacobians", "[", 
   RowBox[{"patchName_", ",", "patch_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "outputStr", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputStr", "=", 
      RowBox[{"\"\<case PatchPiece::\>\"", "<>", "patchName", 
       "<>", "\"\<:\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"outputStr", "=", 
        RowBox[{"outputStr", "<>", "\[IndentingNewLine]", "\"\<    J(\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<)(\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"j", "-", "1"}], "]"}], "<>", "\"\<) = \>\"", "<>", 
         "\[IndentingNewLine]", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"FullSimplify", "[", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "patch", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[LeftDoubleBracket]",
                "j", "\[RightDoubleBracket]"}]}], "]"}], "]"}], ",", 
           "CForm"}], "]"}], "<>", "\"\<;\\n\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"outputStr", "=", 
      RowBox[{"outputStr", "<>", "\"\<\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"outputStr", "=", 
        RowBox[{"outputStr", "<>", "\[IndentingNewLine]", "\"\<    dJ(\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<)(\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"j", "-", "1"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"k", "-", "1"}], "]"}], "<>", "\"\<) = \>\"", "<>", 
         "\[IndentingNewLine]", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"FullSimplify", "[", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{
                "patch", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[LeftDoubleBracket]",
                  "j", "\[RightDoubleBracket]"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[LeftDoubleBracket]",
                "k", "\[RightDoubleBracket]"}]}], "]"}], "]"}], ",", 
           "CForm"}], "]"}], "<>", "\"\<;\\n\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"outputStr", "=", 
      RowBox[{"outputStr", "<>", "\"\<    break;\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "outputStr", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.869239711715683*^9, 3.869239807725449*^9}, {
   3.869239921072564*^9, 3.869239927713436*^9}, {3.869239987391498*^9, 
   3.869240073240534*^9}, {3.869240250315014*^9, 3.869240278973666*^9}, {
   3.8692403569332542`*^9, 3.86924035729281*^9}, {3.869242234598077*^9, 
   3.8692422355678596`*^9}, {3.922451257377924*^9, 3.922451275276483*^9}, 
   3.9224513066676083`*^9, {3.9224515986778097`*^9, 3.922451599067176*^9}, {
   3.96757446888507*^9, 3.9675745290438232`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"24dd430f-c257-4863-b47f-f7d4a552d3d2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"generateJacobians", "[", 
  RowBox[{"\"\<cartesian\>\"", ",", "Icart"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"generateJacobians", "[", 
  RowBox[{"\"\<plus_x\>\"", ",", "Ipx"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"generateJacobians", "[", 
  RowBox[{"\"\<plus_y\>\"", ",", "Ipy"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"generateJacobians", "[", 
  RowBox[{"\"\<minus_x\>\"", ",", "Imx"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"generateJacobians", "[", 
  RowBox[{"\"\<minus_y\>\"", ",", "Imy"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"generateJacobians", "[", 
  RowBox[{"\"\<plus_z\>\"", ",", "Ipz"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"generateJacobians", "[", 
  RowBox[{"\"\<minus_z\>\"", ",", "Imz"}], "]"}]}], "Input",
 CellChangeTimes->{{3.96757436198748*^9, 3.967574379508843*^9}, {
  3.967574445621994*^9, 3.967574453802006*^9}, {3.9675745368382387`*^9, 
  3.967574538927772*^9}, {3.967574596483086*^9, 3.967574662355901*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"fda5be34-f34c-4f40-9347-29d6d330f1cc"],

Cell[BoxData["\<\"case PatchPiece::cartesian:\\n    J(0)(0) = 1;\\n    \
J(0)(1) = 0;\\n    J(0)(2) = 0;\\n    J(1)(0) = 0;\\n    J(1)(1) = 1;\\n    \
J(1)(2) = 0;\\n    J(2)(0) = 0;\\n    J(2)(1) = 0;\\n    J(2)(2) = 1;\\n\\n   \
 dJ(0)(0,0) = 0;\\n    dJ(0)(0,1) = 0;\\n    dJ(0)(0,2) = 0;\\n    dJ(0)(1,0) \
= 0;\\n    dJ(0)(1,1) = 0;\\n    dJ(0)(1,2) = 0;\\n    dJ(0)(2,0) = 0;\\n    \
dJ(0)(2,1) = 0;\\n    dJ(0)(2,2) = 0;\\n    dJ(1)(0,0) = 0;\\n    dJ(1)(0,1) \
= 0;\\n    dJ(1)(0,2) = 0;\\n    dJ(1)(1,0) = 0;\\n    dJ(1)(1,1) = 0;\\n    \
dJ(1)(1,2) = 0;\\n    dJ(1)(2,0) = 0;\\n    dJ(1)(2,1) = 0;\\n    dJ(1)(2,2) \
= 0;\\n    dJ(2)(0,0) = 0;\\n    dJ(2)(0,1) = 0;\\n    dJ(2)(0,2) = 0;\\n    \
dJ(2)(1,0) = 0;\\n    dJ(2)(1,1) = 0;\\n    dJ(2)(1,2) = 0;\\n    dJ(2)(2,0) \
= 0;\\n    dJ(2)(2,1) = 0;\\n    dJ(2)(2,2) = 0;\\n    break;\\n\"\>"], \
"Output",
 CellChangeTimes->{
  3.967574454039349*^9, {3.967574523852476*^9, 3.967574539328891*^9}, 
   3.96757466425464*^9, 3.967574866296774*^9, 3.9675749209248333`*^9, 
   3.967574999781465*^9, 3.973079572742157*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"c37a271f-d6fa-4267-bb63-7cce487c5214"],

Cell[BoxData["\<\"case PatchPiece::plus_x:\\n    J(0)(0) = -(z/pow(x,2));\\n  \
  J(0)(1) = 0;\\n    J(0)(2) = 1/x;\\n    J(1)(0) = -(y/pow(x,2));\\n    \
J(1)(1) = 1/x;\\n    J(1)(2) = 0;\\n    J(2)(0) = \
(4*x)/sqrt(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)));\\n    J(2)(1) = (2*y*(1 + (2*r0*(r0 - r1) + pow(y,2) + \
pow(z,2))/sqrt(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)))))/pow(r0 - r1,2);\\n    J(2)(2) = (2*z*(1 + (2*r0*(r0 - r1) + \
pow(y,2) + pow(z,2))/sqrt(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)))))/pow(r0 - r1,2);\\n\\n    dJ(0)(0,0) = (2*z)/pow(x,3);\\n    \
dJ(0)(0,1) = 0;\\n    dJ(0)(0,2) = -pow(x,-2);\\n    dJ(0)(1,0) = 0;\\n    \
dJ(0)(1,1) = 0;\\n    dJ(0)(1,2) = 0;\\n    dJ(0)(2,0) = -pow(x,-2);\\n    \
dJ(0)(2,1) = 0;\\n    dJ(0)(2,2) = 0;\\n    dJ(1)(0,0) = (2*y)/pow(x,3);\\n   \
 dJ(1)(0,1) = -pow(x,-2);\\n    dJ(1)(0,2) = 0;\\n    dJ(1)(1,0) = \
-pow(x,-2);\\n    dJ(1)(1,1) = 0;\\n    dJ(1)(1,2) = 0;\\n    dJ(1)(2,0) = 0;\
\\n    dJ(1)(2,1) = 0;\\n    dJ(1)(2,2) = 0;\\n    dJ(2)(0,0) = (4*(pow(y,2) \
+ pow(z,2))*(4*r0*(r0 - r1) + pow(y,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(x,2) \
+ pow(pow(y,2) + pow(z,2),2) + 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - \
4*r0*r1*(2*pow(x,2) + pow(y,2) + pow(z,2)),1.5);\\n    dJ(2)(0,1) = \
(-8*x*y*(2*r0*(r0 - r1) + pow(y,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(x,2) + \
pow(pow(y,2) + pow(z,2),2) + 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - \
4*r0*r1*(2*pow(x,2) + pow(y,2) + pow(z,2)),1.5);\\n    dJ(2)(0,2) = \
(-8*x*z*(2*r0*(r0 - r1) + pow(y,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(x,2) + \
pow(pow(y,2) + pow(z,2),2) + 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - \
4*r0*r1*(2*pow(x,2) + pow(y,2) + pow(z,2)),1.5);\\n    dJ(2)(1,0) = \
(-8*x*y*(2*r0*(r0 - r1) + pow(y,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(x,2) + \
pow(pow(y,2) + pow(z,2),2) + 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - \
4*r0*r1*(2*pow(x,2) + pow(y,2) + pow(z,2)),1.5);\\n    dJ(2)(1,1) = (2 - \
(4*pow(y,2)*pow(2*r0*(r0 - r1) + pow(y,2) + \
pow(z,2),2))/pow(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)),1.5) + (2*(2*r0*(r0 - r1) + 3*pow(y,2) + \
pow(z,2)))/sqrt(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2))))/pow(r0 - r1,2);\\n    dJ(2)(1,2) = (16*(-pow(r0,2) + \
pow(x,2))*y*z)/pow(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(2,0) = (-8*x*z*(2*r0*(r0 - r1) + pow(y,2) + \
pow(z,2)))/pow(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(2,1) = (16*(-pow(r0,2) + \
pow(x,2))*y*z)/pow(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(2,2) = (2 - (4*pow(z,2)*pow(2*r0*(r0 - r1) + \
pow(y,2) + pow(z,2),2))/pow(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) \
+ 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + \
pow(y,2) + pow(z,2)),1.5) + (2*(2*r0*(r0 - r1) + pow(y,2) + \
3*pow(z,2)))/sqrt(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2))))/pow(r0 - r1,2);\\n    break;\\n\"\>"], "Output",
 CellChangeTimes->{
  3.967574454039349*^9, {3.967574523852476*^9, 3.967574539328891*^9}, 
   3.96757466425464*^9, 3.967574866296774*^9, 3.9675749209248333`*^9, 
   3.967574999781465*^9, 3.9730795768835983`*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"8c7e05b1-2599-4bd9-8547-b670f43f5b9a"],

Cell[BoxData["\<\"case PatchPiece::plus_y:\\n    J(0)(0) = 0;\\n    J(0)(1) = \
-(z/pow(y,2));\\n    J(0)(2) = 1/y;\\n    J(1)(0) = -(1/y);\\n    J(1)(1) = \
x/pow(y,2);\\n    J(1)(2) = 0;\\n    J(2)(0) = (2*x*(1 + (2*r0*(r0 - r1) + \
pow(x,2) + pow(z,2))/sqrt(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)))))/pow(r0 - r1,2);\\n    J(2)(1) = \
(4*y)/sqrt(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)));\\n    J(2)(2) = (2*z*(1 + (2*r0*(r0 - r1) + pow(x,2) + \
pow(z,2))/sqrt(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)))))/pow(r0 - r1,2);\\n\\n    dJ(0)(0,0) = 0;\\n    dJ(0)(0,1) = 0;\
\\n    dJ(0)(0,2) = 0;\\n    dJ(0)(1,0) = 0;\\n    dJ(0)(1,1) = \
(2*z)/pow(y,3);\\n    dJ(0)(1,2) = -pow(y,-2);\\n    dJ(0)(2,0) = 0;\\n    \
dJ(0)(2,1) = -pow(y,-2);\\n    dJ(0)(2,2) = 0;\\n    dJ(1)(0,0) = 0;\\n    \
dJ(1)(0,1) = pow(y,-2);\\n    dJ(1)(0,2) = 0;\\n    dJ(1)(1,0) = \
pow(y,-2);\\n    dJ(1)(1,1) = (-2*x)/pow(y,3);\\n    dJ(1)(1,2) = 0;\\n    \
dJ(1)(2,0) = 0;\\n    dJ(1)(2,1) = 0;\\n    dJ(1)(2,2) = 0;\\n    dJ(2)(0,0) \
= (2 - (4*pow(x,2)*pow(2*r0*(r0 - r1) + pow(x,2) + \
pow(z,2),2))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5) + (2*(2*r0*(r0 - r1) + 3*pow(x,2) + \
pow(z,2)))/sqrt(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2))))/pow(r0 - r1,2);\\n    dJ(2)(0,1) = (-8*x*y*(2*r0*(r0 - r1) + \
pow(x,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(0,2) = (16*x*(-pow(r0,2) + \
pow(y,2))*z)/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(1,0) = (-8*x*y*(2*r0*(r0 - r1) + pow(x,2) + \
pow(z,2)))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(1,1) = (4*(pow(x,2) + pow(z,2))*(4*r0*(r0 - r1) \
+ pow(x,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) \
+ 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + \
2*pow(y,2) + pow(z,2)),1.5);\\n    dJ(2)(1,2) = (-8*y*z*(2*r0*(r0 - r1) + \
pow(x,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(2,0) = (16*x*(-pow(r0,2) + \
pow(y,2))*z)/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(2,1) = (-8*y*z*(2*r0*(r0 - r1) + pow(x,2) + \
pow(z,2)))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(2,2) = (2 - (4*pow(z,2)*pow(2*r0*(r0 - r1) + \
pow(x,2) + pow(z,2),2))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) \
+ 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + \
2*pow(y,2) + pow(z,2)),1.5) + (2*(2*r0*(r0 - r1) + pow(x,2) + \
3*pow(z,2)))/sqrt(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2))))/pow(r0 - r1,2);\\n    break;\\n\"\>"], "Output",
 CellChangeTimes->{
  3.967574454039349*^9, {3.967574523852476*^9, 3.967574539328891*^9}, 
   3.96757466425464*^9, 3.967574866296774*^9, 3.9675749209248333`*^9, 
   3.967574999781465*^9, 3.973079580639907*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"e614d970-90c6-4435-b375-4edd7324c438"],

Cell[BoxData["\<\"case PatchPiece::minus_x:\\n    J(0)(0) = z/pow(x,2);\\n    \
J(0)(1) = 0;\\n    J(0)(2) = -(1/x);\\n    J(1)(0) = -(y/pow(x,2));\\n    \
J(1)(1) = 1/x;\\n    J(1)(2) = 0;\\n    J(2)(0) = \
(4*x)/sqrt(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)));\\n    J(2)(1) = (2*y*(1 + (2*r0*(r0 - r1) + pow(y,2) + \
pow(z,2))/sqrt(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)))))/pow(r0 - r1,2);\\n    J(2)(2) = (2*z*(1 + (2*r0*(r0 - r1) + \
pow(y,2) + pow(z,2))/sqrt(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)))))/pow(r0 - r1,2);\\n\\n    dJ(0)(0,0) = (-2*z)/pow(x,3);\\n    \
dJ(0)(0,1) = 0;\\n    dJ(0)(0,2) = pow(x,-2);\\n    dJ(0)(1,0) = 0;\\n    \
dJ(0)(1,1) = 0;\\n    dJ(0)(1,2) = 0;\\n    dJ(0)(2,0) = pow(x,-2);\\n    \
dJ(0)(2,1) = 0;\\n    dJ(0)(2,2) = 0;\\n    dJ(1)(0,0) = (2*y)/pow(x,3);\\n   \
 dJ(1)(0,1) = -pow(x,-2);\\n    dJ(1)(0,2) = 0;\\n    dJ(1)(1,0) = \
-pow(x,-2);\\n    dJ(1)(1,1) = 0;\\n    dJ(1)(1,2) = 0;\\n    dJ(1)(2,0) = 0;\
\\n    dJ(1)(2,1) = 0;\\n    dJ(1)(2,2) = 0;\\n    dJ(2)(0,0) = (4*(pow(y,2) \
+ pow(z,2))*(4*r0*(r0 - r1) + pow(y,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(x,2) \
+ pow(pow(y,2) + pow(z,2),2) + 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - \
4*r0*r1*(2*pow(x,2) + pow(y,2) + pow(z,2)),1.5);\\n    dJ(2)(0,1) = \
(-8*x*y*(2*r0*(r0 - r1) + pow(y,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(x,2) + \
pow(pow(y,2) + pow(z,2),2) + 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - \
4*r0*r1*(2*pow(x,2) + pow(y,2) + pow(z,2)),1.5);\\n    dJ(2)(0,2) = \
(-8*x*z*(2*r0*(r0 - r1) + pow(y,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(x,2) + \
pow(pow(y,2) + pow(z,2),2) + 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - \
4*r0*r1*(2*pow(x,2) + pow(y,2) + pow(z,2)),1.5);\\n    dJ(2)(1,0) = \
(-8*x*y*(2*r0*(r0 - r1) + pow(y,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(x,2) + \
pow(pow(y,2) + pow(z,2),2) + 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - \
4*r0*r1*(2*pow(x,2) + pow(y,2) + pow(z,2)),1.5);\\n    dJ(2)(1,1) = (2 - \
(4*pow(y,2)*pow(2*r0*(r0 - r1) + pow(y,2) + \
pow(z,2),2))/pow(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)),1.5) + (2*(2*r0*(r0 - r1) + 3*pow(y,2) + \
pow(z,2)))/sqrt(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2))))/pow(r0 - r1,2);\\n    dJ(2)(1,2) = (16*(-pow(r0,2) + \
pow(x,2))*y*z)/pow(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(2,0) = (-8*x*z*(2*r0*(r0 - r1) + pow(y,2) + \
pow(z,2)))/pow(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(2,1) = (16*(-pow(r0,2) + \
pow(x,2))*y*z)/pow(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(2,2) = (2 - (4*pow(z,2)*pow(2*r0*(r0 - r1) + \
pow(y,2) + pow(z,2),2))/pow(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) \
+ 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + \
pow(y,2) + pow(z,2)),1.5) + (2*(2*r0*(r0 - r1) + pow(y,2) + \
3*pow(z,2)))/sqrt(4*pow(r1,2)*pow(x,2) + pow(pow(y,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(2*pow(x,2) + pow(y,2) \
+ pow(z,2))))/pow(r0 - r1,2);\\n    break;\\n\"\>"], "Output",
 CellChangeTimes->{
  3.967574454039349*^9, {3.967574523852476*^9, 3.967574539328891*^9}, 
   3.96757466425464*^9, 3.967574866296774*^9, 3.9675749209248333`*^9, 
   3.967574999781465*^9, 3.973079580642222*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"60f6e692-3c94-4ef1-87f6-e04ba1bc502a"],

Cell[BoxData["\<\"case PatchPiece::minus_y:\\n    J(0)(0) = 0;\\n    J(0)(1) \
= z/pow(y,2);\\n    J(0)(2) = -(1/y);\\n    J(1)(0) = -(1/y);\\n    J(1)(1) = \
x/pow(y,2);\\n    J(1)(2) = 0;\\n    J(2)(0) = (2*x*(1 + (2*r0*(r0 - r1) + \
pow(x,2) + pow(z,2))/sqrt(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)))))/pow(r0 - r1,2);\\n    J(2)(1) = \
(4*y)/sqrt(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)));\\n    J(2)(2) = (2*z*(1 + (2*r0*(r0 - r1) + pow(x,2) + \
pow(z,2))/sqrt(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)))))/pow(r0 - r1,2);\\n\\n    dJ(0)(0,0) = 0;\\n    dJ(0)(0,1) = 0;\
\\n    dJ(0)(0,2) = 0;\\n    dJ(0)(1,0) = 0;\\n    dJ(0)(1,1) = \
(-2*z)/pow(y,3);\\n    dJ(0)(1,2) = pow(y,-2);\\n    dJ(0)(2,0) = 0;\\n    \
dJ(0)(2,1) = pow(y,-2);\\n    dJ(0)(2,2) = 0;\\n    dJ(1)(0,0) = 0;\\n    \
dJ(1)(0,1) = pow(y,-2);\\n    dJ(1)(0,2) = 0;\\n    dJ(1)(1,0) = \
pow(y,-2);\\n    dJ(1)(1,1) = (-2*x)/pow(y,3);\\n    dJ(1)(1,2) = 0;\\n    \
dJ(1)(2,0) = 0;\\n    dJ(1)(2,1) = 0;\\n    dJ(1)(2,2) = 0;\\n    dJ(2)(0,0) \
= (2 - (4*pow(x,2)*pow(2*r0*(r0 - r1) + pow(x,2) + \
pow(z,2),2))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5) + (2*(2*r0*(r0 - r1) + 3*pow(x,2) + \
pow(z,2)))/sqrt(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2))))/pow(r0 - r1,2);\\n    dJ(2)(0,1) = (-8*x*y*(2*r0*(r0 - r1) + \
pow(x,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(0,2) = (16*x*(-pow(r0,2) + \
pow(y,2))*z)/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(1,0) = (-8*x*y*(2*r0*(r0 - r1) + pow(x,2) + \
pow(z,2)))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(1,1) = (4*(pow(x,2) + pow(z,2))*(4*r0*(r0 - r1) \
+ pow(x,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) \
+ 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + \
2*pow(y,2) + pow(z,2)),1.5);\\n    dJ(2)(1,2) = (-8*y*z*(2*r0*(r0 - r1) + \
pow(x,2) + pow(z,2)))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(2,0) = (16*x*(-pow(r0,2) + \
pow(y,2))*z)/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(2,1) = (-8*y*z*(2*r0*(r0 - r1) + pow(x,2) + \
pow(z,2)))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2)),1.5);\\n    dJ(2)(2,2) = (2 - (4*pow(z,2)*pow(2*r0*(r0 - r1) + \
pow(x,2) + pow(z,2),2))/pow(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) \
+ 4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + \
2*pow(y,2) + pow(z,2)),1.5) + (2*(2*r0*(r0 - r1) + pow(x,2) + \
3*pow(z,2)))/sqrt(4*pow(r1,2)*pow(y,2) + pow(pow(x,2) + pow(z,2),2) + \
4*pow(r0,2)*(pow(x,2) + pow(y,2) + pow(z,2)) - 4*r0*r1*(pow(x,2) + 2*pow(y,2) \
+ pow(z,2))))/pow(r0 - r1,2);\\n    break;\\n\"\>"], "Output",
 CellChangeTimes->{
  3.967574454039349*^9, {3.967574523852476*^9, 3.967574539328891*^9}, 
   3.96757466425464*^9, 3.967574866296774*^9, 3.9675749209248333`*^9, 
   3.967574999781465*^9, 3.973079580644095*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"b70cccb4-4244-41b0-9598-f1d1ad604137"],

Cell[BoxData["\<\"case PatchPiece::plus_z:\\n    J(0)(0) = -(1/z);\\n    \
J(0)(1) = 0;\\n    J(0)(2) = x/pow(z,2);\\n    J(1)(0) = 0;\\n    J(1)(1) = \
1/z;\\n    J(1)(2) = -(y/pow(z,2));\\n    J(2)(0) = (2*x*(1 + (2*r0*(r0 - r1) \
+ pow(x,2) + pow(y,2))/sqrt((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) \
+ pow(y,2)) + 4*pow(r0 - r1,2)*pow(z,2))))/pow(r0 - r1,2);\\n    J(2)(1) = \
(2*y*(1 + (2*r0*(r0 - r1) + pow(x,2) + pow(y,2))/sqrt((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2))))/pow(r0 - r1,2);\\n    J(2)(2) = (4*z)/sqrt((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2));\\n\\n    dJ(0)(0,0) = 0;\\n    dJ(0)(0,1) = 0;\\n    \
dJ(0)(0,2) = pow(z,-2);\\n    dJ(0)(1,0) = 0;\\n    dJ(0)(1,1) = 0;\\n    \
dJ(0)(1,2) = 0;\\n    dJ(0)(2,0) = pow(z,-2);\\n    dJ(0)(2,1) = 0;\\n    \
dJ(0)(2,2) = (-2*x)/pow(z,3);\\n    dJ(1)(0,0) = 0;\\n    dJ(1)(0,1) = 0;\\n  \
  dJ(1)(0,2) = 0;\\n    dJ(1)(1,0) = 0;\\n    dJ(1)(1,1) = 0;\\n    \
dJ(1)(1,2) = -pow(z,-2);\\n    dJ(1)(2,0) = 0;\\n    dJ(1)(2,1) = -pow(z,-2);\
\\n    dJ(1)(2,2) = (2*y)/pow(z,3);\\n    dJ(2)(0,0) = (2 - \
(4*pow(x,2)*pow(2*r0*(r0 - r1) + pow(x,2) + pow(y,2),2))/pow((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2),1.5) + (2*(2*r0*(r0 - r1) + 3*pow(x,2) + \
pow(y,2)))/sqrt((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) \
+ 4*pow(r0 - r1,2)*pow(z,2)))/pow(r0 - r1,2);\\n    dJ(2)(0,1) = \
(16*x*y*(-pow(r0,2) + pow(z,2)))/pow((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + \
pow(x,2) + pow(y,2)) + 4*pow(r0 - r1,2)*pow(z,2),1.5);\\n    dJ(2)(0,2) = \
(-8*x*(2*r0*(r0 - r1) + pow(x,2) + pow(y,2))*z)/pow((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2),1.5);\\n    dJ(2)(1,0) = (16*x*y*(-pow(r0,2) + \
pow(z,2)))/pow((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + \
4*pow(r0 - r1,2)*pow(z,2),1.5);\\n    dJ(2)(1,1) = (2 - \
(4*pow(y,2)*pow(2*r0*(r0 - r1) + pow(x,2) + pow(y,2),2))/pow((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2),1.5) + (2*(2*r0*(r0 - r1) + pow(x,2) + \
3*pow(y,2)))/sqrt((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + \
pow(y,2)) + 4*pow(r0 - r1,2)*pow(z,2)))/pow(r0 - r1,2);\\n    dJ(2)(1,2) = \
(-8*y*(2*r0*(r0 - r1) + pow(x,2) + pow(y,2))*z)/pow((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2),1.5);\\n    dJ(2)(2,0) = (-8*x*(2*r0*(r0 - r1) + pow(x,2) + \
pow(y,2))*z)/pow((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) \
+ 4*pow(r0 - r1,2)*pow(z,2),1.5);\\n    dJ(2)(2,1) = (-8*y*(2*r0*(r0 - r1) + \
pow(x,2) + pow(y,2))*z)/pow((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) \
+ pow(y,2)) + 4*pow(r0 - r1,2)*pow(z,2),1.5);\\n    dJ(2)(2,2) = (4*(pow(x,2) \
+ pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)))/pow((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2),1.5);\\n    break;\\n\"\>"], "Output",
 CellChangeTimes->{
  3.967574454039349*^9, {3.967574523852476*^9, 3.967574539328891*^9}, 
   3.96757466425464*^9, 3.967574866296774*^9, 3.9675749209248333`*^9, 
   3.967574999781465*^9, 3.9730795844598827`*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"0aeef0c9-3d3f-4961-a24e-b2d949d998c4"],

Cell[BoxData["\<\"case PatchPiece::minus_z:\\n    J(0)(0) = -(1/z);\\n    \
J(0)(1) = 0;\\n    J(0)(2) = x/pow(z,2);\\n    J(1)(0) = 0;\\n    J(1)(1) = \
-(1/z);\\n    J(1)(2) = y/pow(z,2);\\n    J(2)(0) = (2*x*(1 + (2*r0*(r0 - r1) \
+ pow(x,2) + pow(y,2))/sqrt((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) \
+ pow(y,2)) + 4*pow(r0 - r1,2)*pow(z,2))))/pow(r0 - r1,2);\\n    J(2)(1) = \
(2*y*(1 + (2*r0*(r0 - r1) + pow(x,2) + pow(y,2))/sqrt((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2))))/pow(r0 - r1,2);\\n    J(2)(2) = (4*z)/sqrt((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2));\\n\\n    dJ(0)(0,0) = 0;\\n    dJ(0)(0,1) = 0;\\n    \
dJ(0)(0,2) = pow(z,-2);\\n    dJ(0)(1,0) = 0;\\n    dJ(0)(1,1) = 0;\\n    \
dJ(0)(1,2) = 0;\\n    dJ(0)(2,0) = pow(z,-2);\\n    dJ(0)(2,1) = 0;\\n    \
dJ(0)(2,2) = (-2*x)/pow(z,3);\\n    dJ(1)(0,0) = 0;\\n    dJ(1)(0,1) = 0;\\n  \
  dJ(1)(0,2) = 0;\\n    dJ(1)(1,0) = 0;\\n    dJ(1)(1,1) = 0;\\n    \
dJ(1)(1,2) = pow(z,-2);\\n    dJ(1)(2,0) = 0;\\n    dJ(1)(2,1) = \
pow(z,-2);\\n    dJ(1)(2,2) = (-2*y)/pow(z,3);\\n    dJ(2)(0,0) = (2 - \
(4*pow(x,2)*pow(2*r0*(r0 - r1) + pow(x,2) + pow(y,2),2))/pow((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2),1.5) + (2*(2*r0*(r0 - r1) + 3*pow(x,2) + \
pow(y,2)))/sqrt((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) \
+ 4*pow(r0 - r1,2)*pow(z,2)))/pow(r0 - r1,2);\\n    dJ(2)(0,1) = \
(16*x*y*(-pow(r0,2) + pow(z,2)))/pow((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + \
pow(x,2) + pow(y,2)) + 4*pow(r0 - r1,2)*pow(z,2),1.5);\\n    dJ(2)(0,2) = \
(-8*x*(2*r0*(r0 - r1) + pow(x,2) + pow(y,2))*z)/pow((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2),1.5);\\n    dJ(2)(1,0) = (16*x*y*(-pow(r0,2) + \
pow(z,2)))/pow((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + \
4*pow(r0 - r1,2)*pow(z,2),1.5);\\n    dJ(2)(1,1) = (2 - \
(4*pow(y,2)*pow(2*r0*(r0 - r1) + pow(x,2) + pow(y,2),2))/pow((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2),1.5) + (2*(2*r0*(r0 - r1) + pow(x,2) + \
3*pow(y,2)))/sqrt((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + \
pow(y,2)) + 4*pow(r0 - r1,2)*pow(z,2)))/pow(r0 - r1,2);\\n    dJ(2)(1,2) = \
(-8*y*(2*r0*(r0 - r1) + pow(x,2) + pow(y,2))*z)/pow((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2),1.5);\\n    dJ(2)(2,0) = (-8*x*(2*r0*(r0 - r1) + pow(x,2) + \
pow(y,2))*z)/pow((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) \
+ 4*pow(r0 - r1,2)*pow(z,2),1.5);\\n    dJ(2)(2,1) = (-8*y*(2*r0*(r0 - r1) + \
pow(x,2) + pow(y,2))*z)/pow((pow(x,2) + pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) \
+ pow(y,2)) + 4*pow(r0 - r1,2)*pow(z,2),1.5);\\n    dJ(2)(2,2) = (4*(pow(x,2) \
+ pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)))/pow((pow(x,2) + \
pow(y,2))*(4*r0*(r0 - r1) + pow(x,2) + pow(y,2)) + 4*pow(r0 - \
r1,2)*pow(z,2),1.5);\\n    break;\\n\"\>"], "Output",
 CellChangeTimes->{
  3.967574454039349*^9, {3.967574523852476*^9, 3.967574539328891*^9}, 
   3.96757466425464*^9, 3.967574866296774*^9, 3.9675749209248333`*^9, 
   3.967574999781465*^9, 3.973079584495688*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"dece7202-2808-4238-8264-28358efffc63"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 756},
WindowMargins->{{1097.25, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
DefaultNaturalLanguage->Language,
FrontEndVersion->"14.2 for Linux x86 (64-bit) (December 26, 2024)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"c7c54479-860f-4a9a-bc66-0ea79160d210"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 437, 6, 95, "Title",ExpressionUUID->"06cf51ac-2049-45e5-befb-5e7a3ea14fb4"],
Cell[CellGroupData[{
Cell[1042, 32, 154, 3, 67, "Section",ExpressionUUID->"c6457ca3-1714-4873-8939-acf5ec5341ca"],
Cell[1199, 37, 1849, 44, 131, "Input",ExpressionUUID->"f9245ca4-e8e9-41b0-ba49-02ff0b656537"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3085, 86, 352, 6, 67, "Section",ExpressionUUID->"4433c9f4-e92e-44f9-a920-9fcf114e462f"],
Cell[3440, 94, 366, 8, 41, "Input",ExpressionUUID->"e02718e7-d42d-49ab-aad7-206b2a63f45a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3843, 107, 211, 4, 67, "Section",ExpressionUUID->"c15fe3d2-3cf8-46ee-8721-be7399087296"],
Cell[CellGroupData[{
Cell[4079, 115, 7328, 192, 921, "Input",ExpressionUUID->"45564e3e-4a33-437b-ad14-76faf69b5efd"],
Cell[CellGroupData[{
Cell[11432, 311, 448, 8, 23, "Print",ExpressionUUID->"5ccf2f96-0242-4325-85f5-8255f324c9c5"],
Cell[11883, 321, 613, 13, 23, "Print",ExpressionUUID->"7ebe74de-fccd-4404-acf9-0fd7dc1c6f46"],
Cell[12499, 336, 614, 13, 23, "Print",ExpressionUUID->"2d353629-b01d-44ef-b633-91fa23914be1"],
Cell[13116, 351, 614, 13, 23, "Print",ExpressionUUID->"b60e45f5-250c-47ee-8a2a-14aa88770f72"],
Cell[13733, 366, 430, 8, 41, "Print",ExpressionUUID->"0b3ef6f8-6602-4321-a6c0-5e60462346b9"],
Cell[14166, 376, 445, 8, 23, "Print",ExpressionUUID->"94301008-ef44-41f7-b2ca-a5dc5c132b53"],
Cell[14614, 386, 783, 17, 23, "Print",ExpressionUUID->"065d2162-f27e-4d5f-9aa3-ca70639f7f82"],
Cell[15400, 405, 791, 17, 23, "Print",ExpressionUUID->"a4e500f7-2570-4505-9157-366af616f89c"],
Cell[16194, 424, 789, 17, 23, "Print",ExpressionUUID->"c499bd5e-777f-4eca-8846-3036eddb8b4a"],
Cell[16986, 443, 430, 8, 41, "Print",ExpressionUUID->"d5c5df34-5bba-4b9e-9ed2-0e08c53f4450"],
Cell[17419, 453, 447, 8, 23, "Print",ExpressionUUID->"e0dd2fdb-b0dd-433d-9a53-ba19051c01e9"],
Cell[17869, 463, 801, 18, 23, "Print",ExpressionUUID->"08391fff-42e8-4437-ab32-0887680648a9"],
Cell[18673, 483, 781, 17, 23, "Print",ExpressionUUID->"fe08c82d-d3b1-435b-8d2b-5ac0428a69db"],
Cell[19457, 502, 789, 17, 23, "Print",ExpressionUUID->"49a9a2d8-85d5-48b1-a203-057eb38fc862"],
Cell[20249, 521, 430, 8, 41, "Print",ExpressionUUID->"0e8bd256-a756-474a-befb-3085c42e2301"],
Cell[20682, 531, 448, 8, 23, "Print",ExpressionUUID->"a79b7cdd-da7d-4faa-866b-31ea13135a25"],
Cell[21133, 541, 793, 18, 23, "Print",ExpressionUUID->"bf4b0162-3c54-4bdb-93d8-41ad204b1c6f"],
Cell[21929, 561, 799, 18, 23, "Print",ExpressionUUID->"c53634a3-0678-46cc-b356-89a63c7ae766"],
Cell[22731, 581, 791, 17, 23, "Print",ExpressionUUID->"99940e6e-effd-4bb9-8747-47636cae9355"],
Cell[23525, 600, 430, 8, 41, "Print",ExpressionUUID->"53cc3413-fb87-4c5f-8675-4b91174ddec0"],
Cell[23958, 610, 446, 8, 23, "Print",ExpressionUUID->"13acffb3-6750-4131-9644-2ca1cb5357f7"],
Cell[24407, 620, 789, 17, 23, "Print",ExpressionUUID->"e111d791-4df6-4cc7-af54-5cfc0d3e6e11"],
Cell[25199, 639, 791, 18, 23, "Print",ExpressionUUID->"b3b7af8d-541f-4a61-8c93-0f1ecc4863dd"],
Cell[25993, 659, 789, 17, 23, "Print",ExpressionUUID->"3f44bf42-77ee-455f-a1c9-83e47f3eccfe"],
Cell[26785, 678, 430, 8, 41, "Print",ExpressionUUID->"c660d4ab-224d-49b6-bb99-5c37cf3c3e7c"],
Cell[27218, 688, 447, 8, 23, "Print",ExpressionUUID->"f53083d1-3dfc-418b-bbf0-69c5e4e52d13"],
Cell[27668, 698, 801, 18, 23, "Print",ExpressionUUID->"3acf4858-57ab-455e-93b9-3b604bded84b"],
Cell[28472, 718, 789, 17, 23, "Print",ExpressionUUID->"ce634ea6-5898-4daa-85d8-4d270c950841"],
Cell[29264, 737, 781, 17, 23, "Print",ExpressionUUID->"5c417754-1e1b-4c3f-8800-28c97bae0f71"],
Cell[30048, 756, 430, 8, 41, "Print",ExpressionUUID->"171bd416-a91a-4f80-a7de-859fa913d47c"],
Cell[30481, 766, 448, 8, 23, "Print",ExpressionUUID->"3cb63f62-e269-4b76-8944-26a5c9acaa28"],
Cell[30932, 776, 791, 17, 23, "Print",ExpressionUUID->"8cf269e0-f108-4692-89af-0bcf4b16335f"],
Cell[31726, 795, 788, 17, 23, "Print",ExpressionUUID->"d76e8907-1a76-407e-b57f-5fd8610a575f"],
Cell[32517, 814, 791, 18, 23, "Print",ExpressionUUID->"95e61c0b-e99c-4983-9aee-2382f75c2299"],
Cell[33311, 834, 430, 8, 41, "Print",ExpressionUUID->"1c2dd392-c1e2-4de4-b8bb-077c0b54c9d4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33802, 849, 257, 4, 67, "Section",ExpressionUUID->"fe49fa3d-90d5-4db5-99a9-4384ecdef012"],
Cell[CellGroupData[{
Cell[34084, 857, 7427, 193, 921, "Input",ExpressionUUID->"773c85fb-2342-4844-9b40-46ebe84a1bb4"],
Cell[CellGroupData[{
Cell[41536, 1054, 550, 9, 23, "Print",ExpressionUUID->"0276016e-ac2c-4cc2-9394-3b6b041e9896"],
Cell[42089, 1065, 712, 14, 23, "Print",ExpressionUUID->"e789d19b-2117-40f4-bb51-cc0023c52df2"],
Cell[42804, 1081, 712, 14, 23, "Print",ExpressionUUID->"09da0896-1f1a-47a3-9228-160d7897dd89"],
Cell[43519, 1097, 712, 14, 23, "Print",ExpressionUUID->"40bed0f9-e7ca-4026-85f2-5fcdb00cee87"],
Cell[44234, 1113, 530, 9, 41, "Print",ExpressionUUID->"c440ee56-6767-402e-8001-3d0717106294"],
Cell[44767, 1124, 545, 9, 23, "Print",ExpressionUUID->"e2a805d0-63ee-41c8-9d78-d827e5a44756"],
Cell[45315, 1135, 716, 14, 23, "Print",ExpressionUUID->"b5410e1d-e66b-4710-8b68-1d81da5684c2"],
Cell[46034, 1151, 716, 14, 23, "Print",ExpressionUUID->"ba8e42a2-342c-453e-b3b0-de79252dfc09"],
Cell[46753, 1167, 1147, 21, 41, "Print",ExpressionUUID->"5ede6e5e-1918-4e41-998e-ed8719cd503b"],
Cell[47903, 1190, 530, 9, 41, "Print",ExpressionUUID->"17ff56cd-2637-4b69-9bfa-976daf469c00"],
Cell[48436, 1201, 545, 9, 23, "Print",ExpressionUUID->"44893ec3-ad15-48dc-bef0-c4d964056077"],
Cell[48984, 1212, 716, 14, 23, "Print",ExpressionUUID->"fb7ff948-cd28-45d4-896d-b7a120d827d6"],
Cell[49703, 1228, 721, 14, 23, "Print",ExpressionUUID->"50e27581-b72d-4695-9eb7-6a874c4efe8d"],
Cell[50427, 1244, 1149, 21, 41, "Print",ExpressionUUID->"765f83be-8107-4bdb-ae56-fecdb40922ba"],
Cell[51579, 1267, 532, 9, 41, "Print",ExpressionUUID->"a24ff2e6-cc24-490e-af88-2bf1c719ce0e"],
Cell[52114, 1278, 548, 9, 23, "Print",ExpressionUUID->"aa3bdf61-3790-4f4a-afdb-fa95d0be57da"],
Cell[52665, 1289, 722, 14, 23, "Print",ExpressionUUID->"ceb8bbd5-83f7-461f-b299-32e432a54a5c"],
Cell[53390, 1305, 714, 14, 23, "Print",ExpressionUUID->"70426655-f752-44cc-a021-6191cd129d62"],
Cell[54107, 1321, 1147, 21, 41, "Print",ExpressionUUID->"22fb0033-2fba-4a78-a1fb-3b04a434fbb3"],
Cell[55257, 1344, 530, 9, 41, "Print",ExpressionUUID->"3ffcf74e-7e37-47a5-9d09-f608d1af0e76"],
Cell[55790, 1355, 546, 9, 23, "Print",ExpressionUUID->"fe062614-1bd2-415c-8f8d-e4230d9b6a66"],
Cell[56339, 1366, 722, 14, 23, "Print",ExpressionUUID->"879c59ad-ad5b-4919-8d91-d75489a749ee"],
Cell[57064, 1382, 722, 14, 23, "Print",ExpressionUUID->"712c84a9-fde1-499a-8680-1474e08eb0bb"],
Cell[57789, 1398, 1147, 21, 41, "Print",ExpressionUUID->"7d514b6d-8f71-4732-a24e-83fd466362e9"],
Cell[58939, 1421, 532, 9, 41, "Print",ExpressionUUID->"d0812132-cece-4969-8c9d-63d489965ad0"],
Cell[59474, 1432, 547, 9, 23, "Print",ExpressionUUID->"f5901f42-d247-4edf-8bfc-9c597ea68c19"],
Cell[60024, 1443, 724, 14, 23, "Print",ExpressionUUID->"6d9a6af7-1092-4a8d-9616-9861fc027473"],
Cell[60751, 1459, 718, 14, 23, "Print",ExpressionUUID->"f72caa0b-6d7b-400a-aafb-3bb4ae998e55"],
Cell[61472, 1475, 1041, 20, 23, "Print",ExpressionUUID->"1c0dc1bb-a30e-48f3-885e-31f8dc463cc5"],
Cell[62516, 1497, 532, 9, 41, "Print",ExpressionUUID->"ae371bb4-b434-42c5-a403-685f029bb82c"],
Cell[63051, 1508, 548, 9, 23, "Print",ExpressionUUID->"4a2cbd26-001c-4a44-89d4-3389d31b04fd"],
Cell[63602, 1519, 724, 14, 23, "Print",ExpressionUUID->"14054735-e1a8-4267-89c2-cf993f7dfef1"],
Cell[64329, 1535, 724, 14, 23, "Print",ExpressionUUID->"8beb5503-7156-40e1-bfe8-54bbc0f73c7d"],
Cell[65056, 1551, 1039, 20, 23, "Print",ExpressionUUID->"a6308fe0-519c-4377-a621-9976b965c396"],
Cell[66098, 1573, 532, 9, 41, "Print",ExpressionUUID->"b75c627f-d257-4599-8cda-872f0d3bb7f8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66691, 1589, 298, 5, 67, "Section",ExpressionUUID->"d9a6ec80-94ff-4010-a85e-5a76d9141abd"],
Cell[66992, 1596, 1247, 32, 113, "Text",ExpressionUUID->"a1dc3eef-aba1-46f5-8810-b875ef843746"],
Cell[68242, 1630, 4286, 93, 512, "Input",ExpressionUUID->"24dd430f-c257-4863-b47f-f7d4a552d3d2"],
Cell[CellGroupData[{
Cell[72553, 1727, 1062, 18, 175, "Input",ExpressionUUID->"fda5be34-f34c-4f40-9347-29d6d330f1cc"],
Cell[73618, 1747, 1157, 16, 845, "Output",ExpressionUUID->"c37a271f-d6fa-4267-bb63-7cce487c5214"],
Cell[74778, 1765, 4112, 56, 1102, "Output",ExpressionUUID->"8c7e05b1-2599-4bd9-8547-b670f43f5b9a"],
Cell[78893, 1823, 4109, 56, 1082, "Output",ExpressionUUID->"e614d970-90c6-4435-b375-4edd7324c438"],
Cell[83005, 1881, 4110, 56, 1102, "Output",ExpressionUUID->"60f6e692-3c94-4ef1-87f6-e04ba1bc502a"],
Cell[87118, 1939, 4109, 56, 1082, "Output",ExpressionUUID->"b70cccb4-4244-41b0-9598-f1d1ad604137"],
Cell[91230, 1997, 3351, 47, 961, "Output",ExpressionUUID->"0aeef0c9-3d3f-4961-a24e-b2d949d998c4"],
Cell[94584, 2046, 3349, 47, 961, "Output",ExpressionUUID->"dece7202-2808-4238-8264-28358efffc63"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

