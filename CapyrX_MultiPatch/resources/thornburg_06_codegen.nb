(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     93003,       1955]
NotebookOptionsPosition[     84619,       1837]
NotebookOutlinePosition[     85217,       1857]
CellTagsIndexPosition[     85174,       1854]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Thornburg06 Jacobian code generation", "Title",
 CellChangeTimes->{{3.842480859572761*^9, 3.8424808734034557`*^9}, {
  3.842742869283586*^9, 3.842742878013317*^9}, {3.843003248017685*^9, 
  3.843003253996933*^9}, {3.843838607912539*^9, 3.8438386131860456`*^9}, {
  3.8692317274362097`*^9, 3.86923173082513*^9}, {3.869232009919592*^9, 
  3.869232010579658*^9}, {3.9752684418056726`*^9, 
  3.9752684455720873`*^9}},ExpressionUUID->"06cf51ac-2049-45e5-befb-\
5e7a3ea14fb4"],

Cell[CellGroupData[{

Cell["Formating", "Section",
 CellChangeTimes->{{3.967573361840172*^9, 
  3.967573362928553*^9}},ExpressionUUID->"c6457ca3-1714-4873-8939-\
acf5ec5341ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"Power", ",", "Sqrt"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"HoldForm", "[", 
    RowBox[{"(", 
     RowBox[{"1", "/", "a"}], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"1", "/", "2"}]}], "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"sqrt", "[", "a", "]"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"pow", "[", 
     RowBox[{"a", ",", "b"}], "]"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Sqrt", "[", "a_", "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"sqrt", "[", "a", "]"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"Power", ",", "Sqrt"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQfaN7D3tJ5VtHp8TDHCC6pr6ZB0RP2uXIC6JdNojZ
guibRgVg+tO2vBXHgPS+2J9rQHTO3qmHWRveOgZoXz4Gon1eadSyN751zMtX
rAPRXFOym0A0y6y/LSDaIlZ0GYg+UnoXTDfJ3Nf/3/zW8UXlNzBtNnlbNojW
ctPIB9ELWt8Ugeh5+UuKQfSk9PkbuvvfOj752r8DRL+y3p7eA6Rlw3dkgOh1
rL/yQbTSBZUCEM2zJrYSREftPQ6mX4j94rWc99ax6peNEIi+IvVCCkRP018j
A6LX7DVRA9F5rDJaIHrPvi32IDrrd4griA56+OOWK5Dmlbh8F0QDAJGvpgQ=

  "],
 CellLabel->"In[1]:=",ExpressionUUID->"f9245ca4-e8e9-41b0-ba49-02ff0b656537"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Patch system ", "Section",
 CellChangeTimes->{{3.8448108646711617`*^9, 3.844810871321*^9}, {
  3.845641104146451*^9, 3.845641105656435*^9}, {3.8456414906301517`*^9, 
  3.845641495240016*^9}, {3.845641576798369*^9, 3.845641578368043*^9}, {
  3.922450748171774*^9, 
  3.922450748500943*^9}},ExpressionUUID->"4433c9f4-e92e-44f9-a920-\
9fcf114e462f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Import", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], 
    "<>", "\"\<thornburg_06.mx\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.922450751043352*^9, 3.922450774200289*^9}, {
  3.967573160644453*^9, 3.967573160863604*^9}, {3.975268450772077*^9, 
  3.9752684522475863`*^9}, {3.975268507581697*^9, 3.975268507854414*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"e02718e7-d42d-49ab-aad7-206b2a63f45a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Local to global", "Section",
 CellChangeTimes->{{3.967573169535993*^9, 3.967573172701343*^9}, {
  3.967573211725782*^9, 
  3.9675732151095133`*^9}},ExpressionUUID->"c15fe3d2-3cf8-46ee-8721-\
be7399087296"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::plus_x:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"px", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"px", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"px", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::plus_y:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"py", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"py", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"py", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::minus_x:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"mx", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"mx", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"mx", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::minus_y:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"my", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"my", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"my", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::plus_z:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"pz", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"pz", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"pz", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::minus_z:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"mz", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"mz", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<global_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"mz", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.967573512212557*^9, 3.967573516165152*^9}, {
  3.967573581881*^9, 3.967573588715043*^9}, {3.967573734788217*^9, 
  3.967573734962173*^9}, {3.967573772497283*^9, 3.967573833008089*^9}, {
  3.967573903439476*^9, 3.967573905740672*^9}, {3.975268516407228*^9, 
  3.975268517685094*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"45564e3e-4a33-437b-ad14-76faf69b5efd"],

Cell[CellGroupData[{

Cell[BoxData["\<\"case PatchPiece::plus_x:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314899807`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"911f1ab4-afb7-48db-9700-e5b83ddc528d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(0) = \"\>", 
   "\[InvisibleSpace]", "\<\"(r0 - c*r0 + r1 + c*r1)/(2.*sqrt(1 + pow(a,2) + \
pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(0) = ", 
   "(r0 - c*r0 + r1 + c*r1)/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831490322*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"01b3b217-0f8a-46d8-a240-53d30495e969"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(1) = \"\>", 
   "\[InvisibleSpace]", "\<\"(b*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + \
pow(a,2) + pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(1) = ", 
   "(b*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831490888*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"18269213-84ff-4a63-a9b5-6d0d1d63189a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(a*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + \
pow(a,2) + pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(2) = ", 
   "(a*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.97529583149116*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"3d32dc03-7507-491d-88b6-c8fd0d645387"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831491419*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"ca5264d5-7544-40e4-a926-c21f1409ab4e"],

Cell[BoxData["\<\"case PatchPiece::plus_y:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831491624*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"33496879-5edd-42bd-bc24-2cf887b4668b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(0) = \"\>", 
   "\[InvisibleSpace]", "\<\"(b*((-1 + c)*r0 - (1 + c)*r1))/(2.*sqrt(1 + \
pow(a,2) + pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(0) = ", 
   "(b*((-1 + c)*r0 - (1 + c)*r1))/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831491839*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"a02f2cbd-254b-4acf-b8bd-a7e8c1491574"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(1) = \"\>", 
   "\[InvisibleSpace]", "\<\"(r0 - c*r0 + r1 + c*r1)/(2.*sqrt(1 + pow(a,2) + \
pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(1) = ", 
   "(r0 - c*r0 + r1 + c*r1)/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314921007`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"d3c16b13-67d7-4016-bca5-196338fea98e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(a*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + \
pow(a,2) + pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(2) = ", 
   "(a*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314923363`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"70574269-d600-4c2f-b093-9c31389ab77d"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.97529583149257*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"2d781cbb-42a8-472b-ac01-fcfcf2281ba6"],

Cell[BoxData["\<\"case PatchPiece::minus_x:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314927692`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"8d1ac5aa-28e7-4897-871b-58de9726c568"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(0) = \"\>", 
   "\[InvisibleSpace]", "\<\"((-1 + c)*r0 - (1 + c)*r1)/(2.*sqrt(1 + pow(a,2) \
+ pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(0) = ", 
   "((-1 + c)*r0 - (1 + c)*r1)/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831492972*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"4fa3e576-d9c8-4535-ad59-f0e6af7cb9e2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(1) = \"\>", 
   "\[InvisibleSpace]", "\<\"(b*((-1 + c)*r0 - (1 + c)*r1))/(2.*sqrt(1 + \
pow(a,2) + pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(1) = ", 
   "(b*((-1 + c)*r0 - (1 + c)*r1))/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831493209*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"0d872fad-9875-4eb2-9a41-60dd0a1f3907"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(a*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + \
pow(a,2) + pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(2) = ", 
   "(a*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831493453*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"cee1d722-49e9-4b7c-8057-a84d157e244a"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314937077`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"14c53ad7-cebf-4343-97fe-70788f0ad76d"],

Cell[BoxData["\<\"case PatchPiece::minus_y:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314939127`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"3289080d-45c0-4392-a612-d26541f8a84a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(0) = \"\>", 
   "\[InvisibleSpace]", "\<\"(b*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + \
pow(a,2) + pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(0) = ", 
   "(b*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314941196`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"fbe71d81-65c8-4a89-a062-cd506184473b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(1) = \"\>", 
   "\[InvisibleSpace]", "\<\"((-1 + c)*r0 - (1 + c)*r1)/(2.*sqrt(1 + pow(a,2) \
+ pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(1) = ", 
   "((-1 + c)*r0 - (1 + c)*r1)/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831494357*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"b8a42c52-33d4-4fb4-9617-051c3a0819ec"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(a*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + \
pow(a,2) + pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(2) = ", 
   "(a*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314945908`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"52ae0f51-d654-4f28-ada5-8a076e263736"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831494821*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"6049124b-8156-45f3-aab2-734f6c522005"],

Cell[BoxData["\<\"case PatchPiece::plus_z:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314950027`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"708b3bb1-ea5e-491a-a005-355751ec73f9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(0) = \"\>", 
   "\[InvisibleSpace]", "\<\"(a*((-1 + c)*r0 - (1 + c)*r1))/(2.*sqrt(1 + \
pow(a,2) + pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(0) = ", 
   "(a*((-1 + c)*r0 - (1 + c)*r1))/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314951973`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"e971f7bf-bf5d-4b62-94d6-b45a88ef4d67"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(1) = \"\>", 
   "\[InvisibleSpace]", "\<\"(b*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + \
pow(a,2) + pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(1) = ", 
   "(b*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314954233`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"5d2aae18-4ddd-4422-8501-710a701a0689"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(r0 - c*r0 + r1 + c*r1)/(2.*sqrt(1 + pow(a,2) + \
pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(2) = ", 
   "(r0 - c*r0 + r1 + c*r1)/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314956493`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"5fa13286-2eec-4411-adca-a83956e51c2f"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314958763`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"bf39f06f-d681-4416-b71c-14c689d95442"],

Cell[BoxData["\<\"case PatchPiece::minus_z:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831496056*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"7a1e7cac-93f4-49f8-b632-3af1c284ed65"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(0) = \"\>", 
   "\[InvisibleSpace]", "\<\"(a*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + \
pow(a,2) + pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(0) = ", 
   "(a*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.9752958314962473`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"a60d3176-33ef-4069-a066-93b447a60b02"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(1) = \"\>", 
   "\[InvisibleSpace]", "\<\"(b*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + \
pow(a,2) + pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(1) = ", 
   "(b*(r0 - c*r0 + r1 + c*r1))/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831496472*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"4dfe2d5b-0b7d-436c-942e-dd06ff009ef0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"global_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"((-1 + c)*r0 - (1 + c)*r1)/(2.*sqrt(1 + pow(a,2) \
+ pow(b,2)))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "global_coords(2) = ", 
   "((-1 + c)*r0 - (1 + c)*r1)/(2.*sqrt(1 + pow(a,2) + pow(b,2)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831496728*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"c9dbc117-f080-42d5-a7a1-38d4d48429d6"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574866110799*^9, 3.967574920773238*^9, 3.967574999661437*^9, 
   3.973079502021059*^9, 3.973079572634746*^9, 3.975268520882477*^9, 
   3.975268584891881*^9, 3.975268919984713*^9, 3.975294706556067*^9, 
   3.975294768391615*^9, 3.975295831496945*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"54ecd846-5d07-4dce-8857-ea075ac4f479"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Global to local", "Section",
 CellChangeTimes->{{3.967573169535993*^9, 3.967573172701343*^9}, {
  3.967573211725782*^9, 3.9675732151095133`*^9}, {3.967573970285174*^9, 
  3.967573978071368*^9}},ExpressionUUID->"fe49fa3d-90d5-4db5-99a9-\
4384ecdef012"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::plus_x:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipx", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipx", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipx", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::plus_y:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipy", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipy", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipy", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::minus_x:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imx", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imx", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imx", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::minus_y:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imy", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imy", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imy", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::plus_z:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipz", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipz", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Ipz", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<case PatchPiece::minus_z:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(0) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imz", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(1) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imz", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<local_coords(2) = \>\"", ",", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"Imz", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "CForm"}], "]"}], 
   ",", "\"\<;\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<break;\\n\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.967573512212557*^9, 3.967573516165152*^9}, {
  3.967573581881*^9, 3.967573588715043*^9}, {3.967573734788217*^9, 
  3.967573734962173*^9}, {3.967573772497283*^9, 3.967573833008089*^9}, {
  3.967573903439476*^9, 3.967573905740672*^9}, {3.967573985846487*^9, 
  3.96757404331992*^9}, {3.9675741172867126`*^9, 3.9675741634914207`*^9}, {
  3.975268632741515*^9, 3.975268634231059*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"773c85fb-2342-4844-9b40-46ebe84a1bb4"],

Cell[CellGroupData[{

Cell[BoxData["\<\"case PatchPiece::plus_x:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831525769*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"f9afc488-1de6-45a7-a3eb-988b8c31c414"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"z/x\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(0) = ", "z/x", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831526134*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"5a8fdcb7-33b0-4fc0-b8d4-674ac8b26378"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"y/x\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(1) = ", "y/x", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831526662*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"77b9075a-f793-4dc9-8b0b-e712b1d51b68"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(r0 + r1 - 2*sqrt(pow(x,2) + pow(y,2) + \
pow(z,2)))/(r0 - r1)\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "local_coords(2) = ", 
   "(r0 + r1 - 2*sqrt(pow(x,2) + pow(y,2) + pow(z,2)))/(r0 - r1)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831526902*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"b961cd29-9fab-4d1c-ae8b-d799d07d4700"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.9752958315271673`*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"70f80eee-5045-4c42-8da9-13e75fb51685"],

Cell[BoxData["\<\"case PatchPiece::plus_y:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.9752958315273733`*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"692fce85-23fb-4036-a9b9-d2148a934f69"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"z/y\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(0) = ", "z/y", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831527589*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"32129238-54bd-49e7-91aa-257fd4eb461f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"-(x/y)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(1) = ", "-(x/y)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831527812*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"1ac5a99b-6168-495b-b825-013d08092f11"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(r0 + r1 - 2*sqrt(pow(x,2) + pow(y,2) + \
pow(z,2)))/(r0 - r1)\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "local_coords(2) = ", 
   "(r0 + r1 - 2*sqrt(pow(x,2) + pow(y,2) + pow(z,2)))/(r0 - r1)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.9752958315280333`*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"0ed6781b-e3d6-4c61-9331-28e320c72283"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831528262*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"669673a6-1b99-4a81-86e4-8e9ca24460d5"],

Cell[BoxData["\<\"case PatchPiece::minus_x:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831528448*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"12b3ea1e-1478-4150-ada1-22c5aa31a92e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"-(z/x)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(0) = ", "-(z/x)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831528665*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"6ba9cf5c-841e-4c5b-8c6a-0062dfc8ccda"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"y/x\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(1) = ", "y/x", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831528891*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"af454a7d-bad8-49b0-aa26-1df79c94dfae"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(r0 + r1 - 2*sqrt(pow(x,2) + pow(y,2) + \
pow(z,2)))/(r0 - r1)\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "local_coords(2) = ", 
   "(r0 + r1 - 2*sqrt(pow(x,2) + pow(y,2) + pow(z,2)))/(r0 - r1)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.9752958315290956`*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"5050a22d-9b33-4ff2-9ca6-44f62d23d7b2"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831529314*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"975baffe-e0b4-457e-9c1c-b81e6677a72a"],

Cell[BoxData["\<\"case PatchPiece::minus_y:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831529491*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"69249e88-c95c-476e-953d-d10260672d30"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"-(z/y)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(0) = ", "-(z/y)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.9752958315296907`*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"e4cc5a37-376d-40bf-92ff-6527f5256894"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"-(x/y)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(1) = ", "-(x/y)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831529893*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"5dc542e3-ebd6-42fb-842e-4a0ff5aee12d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(r0 + r1 - 2*sqrt(pow(x,2) + pow(y,2) + \
pow(z,2)))/(r0 - r1)\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "local_coords(2) = ", 
   "(r0 + r1 - 2*sqrt(pow(x,2) + pow(y,2) + pow(z,2)))/(r0 - r1)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.9752958315301027`*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"c0d25e85-8340-470c-90f5-f5f109f02be3"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.9752958315303164`*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"eea7e465-3381-4a1b-a11e-fc075860401b"],

Cell[BoxData["\<\"case PatchPiece::plus_z:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831530492*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"d86bbd0a-6c5f-45f1-9946-ab038d651873"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"-(x/z)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(0) = ", "-(x/z)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831530692*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"c0fcf53a-0a1d-4f03-bd3f-aef22dbdfe17"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"y/z\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(1) = ", "y/z", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831530901*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"ab055b7f-8724-45b5-972d-3f3f8a47005a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(r0 + r1 - 2*sqrt(pow(x,2) + pow(y,2) + \
pow(z,2)))/(r0 - r1)\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "local_coords(2) = ", 
   "(r0 + r1 - 2*sqrt(pow(x,2) + pow(y,2) + pow(z,2)))/(r0 - r1)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831531104*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"a38f13fa-ac42-4055-8b46-6332ee14a2f0"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.9752958315313263`*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"6761da85-4bd8-47e0-bfee-6507f596a213"],

Cell[BoxData["\<\"case PatchPiece::minus_z:\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831531502*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"1b8f5fd9-9505-4a4a-81cb-73dedadc5fec"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(0) = \"\>", "\[InvisibleSpace]", "\<\"-(x/z)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(0) = ", "-(x/z)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831531704*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"364ac97f-7e40-40d7-bfca-8ecb96689cbd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(1) = \"\>", "\[InvisibleSpace]", "\<\"-(y/z)\"\>",
    "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["local_coords(1) = ", "-(y/z)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.975295831531904*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"3599eaf7-1616-4dd3-a4fa-4c793231959c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"local_coords(2) = \"\>", 
   "\[InvisibleSpace]", "\<\"(r0 + r1 - 2*sqrt(pow(x,2) + pow(y,2) + \
pow(z,2)))/(r0 - r1)\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "local_coords(2) = ", 
   "(r0 + r1 - 2*sqrt(pow(x,2) + pow(y,2) + pow(z,2)))/(r0 - r1)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.9752958315321074`*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"7d08114b-12d1-412c-8833-fc209c9884aa"],

Cell[BoxData["\<\"break;\\n\"\>"], "Print",
 CellChangeTimes->{
  3.967573517108589*^9, 3.967573589089772*^9, 3.9675737401808357`*^9, {
   3.967573800702832*^9, 3.9675738340527277`*^9}, 3.967573906623807*^9, 
   3.967574013430612*^9, 3.967574107544631*^9, {3.967574141096836*^9, 
   3.9675741645302057`*^9}, 3.967574229381502*^9, 3.9675748661584177`*^9, 
   3.96757492081656*^9, 3.9675749997051573`*^9, 3.9730795726755943`*^9, 
   3.9752686350322523`*^9, 3.975268696905648*^9, 3.975268920026659*^9, 
   3.975294706601062*^9, 3.975294768436447*^9, 3.9752958315323267`*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"65c3aa45-a64b-475b-96fa-263c1969d882"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jacobians and Jacobian Derivatives", "Section",
 CellChangeTimes->{{3.85807029256612*^9, 3.85807030329497*^9}, 
   3.869242415762504*^9, {3.869242688777238*^9, 3.8692426889874*^9}, {
   3.922450895732071*^9, 
   3.922450903911428*^9}},ExpressionUUID->"d9a6ec80-94ff-4010-a85e-\
5a76d9141abd"],

Cell[TextData[{
 "CarpetX defines\n\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"J", "[", "i", "]"}], "[", "j", "]"}], "=", 
    FractionBox[
     SuperscriptBox["da", "i"], 
     SuperscriptBox["dx", "j"]]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"dJ", "[", "i", "]"}], "[", "j", "]"}], "[", "k", "]"}], "=", 
    RowBox[{
     FractionBox["d", 
      SuperscriptBox["dx", "k"]], 
     RowBox[{"(", 
      FractionBox[
       SuperscriptBox["da", "i"], 
       SuperscriptBox["dx", "j"]], ")"}]}]}], TraditionalForm]}],
  ExpressionUUID->"e916b45b-0691-43bb-b104-b99c3792f970"]
}], "Text",
 CellChangeTimes->{{3.8460843424597054`*^9, 3.846084494466394*^9}, {
  3.857120063429269*^9, 3.857120086484022*^9}, {3.857132591638426*^9, 
  3.857132592022197*^9}, {3.8580687165349627`*^9, 3.858068867341958*^9}, {
  3.858069271864131*^9, 3.858069323613624*^9}, {3.858069425391279*^9, 
  3.85806947653013*^9}, {3.8580702263171883`*^9, 3.858070287806102*^9}, {
  3.9224508684843073`*^9, 3.922450890707775*^9}, {3.922451119536634*^9, 
  3.922451120040235*^9}, {3.973079549952407*^9, 
  3.97307955088708*^9}},ExpressionUUID->"a1dc3eef-aba1-46f5-8810-\
b875ef843746"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateJacobians", "[", 
   RowBox[{"patchName_", ",", "patch_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "outputStr", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputStr", "=", 
      RowBox[{"\"\<case PatchPiece::\>\"", "<>", "patchName", 
       "<>", "\"\<:\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"outputStr", "=", 
        RowBox[{"outputStr", "<>", "\[IndentingNewLine]", "\"\<    J(\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<)(\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"j", "-", "1"}], "]"}], "<>", "\"\<) = \>\"", "<>", 
         "\[IndentingNewLine]", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"FullSimplify", "[", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "patch", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[LeftDoubleBracket]",
                "j", "\[RightDoubleBracket]"}]}], "]"}], "]"}], ",", 
           "CForm"}], "]"}], "<>", "\"\<;\\n\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"outputStr", "=", 
      RowBox[{"outputStr", "<>", "\"\<\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"outputStr", "=", 
        RowBox[{"outputStr", "<>", "\[IndentingNewLine]", "\"\<    dJ(\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<)(\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"j", "-", "1"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"k", "-", "1"}], "]"}], "<>", "\"\<) = \>\"", "<>", 
         "\[IndentingNewLine]", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"FullSimplify", "[", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{
                "patch", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[LeftDoubleBracket]",
                  "j", "\[RightDoubleBracket]"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[LeftDoubleBracket]",
                "k", "\[RightDoubleBracket]"}]}], "]"}], "]"}], ",", 
           "CForm"}], "]"}], "<>", "\"\<;\\n\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"outputStr", "=", 
      RowBox[{"outputStr", "<>", "\"\<    break;\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "outputStr", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.869239711715683*^9, 3.869239807725449*^9}, {
   3.869239921072564*^9, 3.869239927713436*^9}, {3.869239987391498*^9, 
   3.869240073240534*^9}, {3.869240250315014*^9, 3.869240278973666*^9}, {
   3.8692403569332542`*^9, 3.86924035729281*^9}, {3.869242234598077*^9, 
   3.8692422355678596`*^9}, {3.922451257377924*^9, 3.922451275276483*^9}, 
   3.9224513066676083`*^9, {3.9224515986778097`*^9, 3.922451599067176*^9}, {
   3.96757446888507*^9, 3.9675745290438232`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"24dd430f-c257-4863-b47f-f7d4a552d3d2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"generateJacobians", "[", 
  RowBox[{"\"\<plus_x\>\"", ",", "Ipx"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"generateJacobians", "[", 
  RowBox[{"\"\<plus_y\>\"", ",", "Ipy"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"generateJacobians", "[", 
  RowBox[{"\"\<minus_x\>\"", ",", "Imx"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"generateJacobians", "[", 
  RowBox[{"\"\<minus_y\>\"", ",", "Imy"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"generateJacobians", "[", 
  RowBox[{"\"\<plus_z\>\"", ",", "Ipz"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"generateJacobians", "[", 
  RowBox[{"\"\<minus_z\>\"", ",", "Imz"}], "]"}]}], "Input",
 CellChangeTimes->{{3.96757436198748*^9, 3.967574379508843*^9}, {
  3.967574445621994*^9, 3.967574453802006*^9}, {3.9675745368382387`*^9, 
  3.967574538927772*^9}, {3.967574596483086*^9, 3.967574662355901*^9}, {
  3.9752687184408197`*^9, 3.975268719965201*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"fda5be34-f34c-4f40-9347-29d6d330f1cc"],

Cell[BoxData["\<\"case PatchPiece::plus_x:\\n    J(0)(0) = -(z/pow(x,2));\\n  \
  J(0)(1) = 0;\\n    J(0)(2) = 1/x;\\n    J(1)(0) = -(y/pow(x,2));\\n    \
J(1)(1) = 1/x;\\n    J(1)(2) = 0;\\n    J(2)(0) = (-2*x)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n    J(2)(1) = (-2*y)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n    J(2)(2) = (-2*z)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n\\n    dJ(0)(0,0) = \
(2*z)/pow(x,3);\\n    dJ(0)(0,1) = 0;\\n    dJ(0)(0,2) = -pow(x,-2);\\n    \
dJ(0)(1,0) = 0;\\n    dJ(0)(1,1) = 0;\\n    dJ(0)(1,2) = 0;\\n    dJ(0)(2,0) \
= -pow(x,-2);\\n    dJ(0)(2,1) = 0;\\n    dJ(0)(2,2) = 0;\\n    dJ(1)(0,0) = \
(2*y)/pow(x,3);\\n    dJ(1)(0,1) = -pow(x,-2);\\n    dJ(1)(0,2) = 0;\\n    \
dJ(1)(1,0) = -pow(x,-2);\\n    dJ(1)(1,1) = 0;\\n    dJ(1)(1,2) = 0;\\n    \
dJ(1)(2,0) = 0;\\n    dJ(1)(2,1) = 0;\\n    dJ(1)(2,2) = 0;\\n    dJ(2)(0,0) \
= (-2*(pow(y,2) + pow(z,2)))/((r0 - r1)*pow(pow(x,2) + pow(y,2) + \
pow(z,2),1.5));\\n    dJ(2)(0,1) = (2*x*y)/((r0 - r1)*pow(pow(x,2) + pow(y,2) \
+ pow(z,2),1.5));\\n    dJ(2)(0,2) = (2*x*z)/((r0 - r1)*pow(pow(x,2) + \
pow(y,2) + pow(z,2),1.5));\\n    dJ(2)(1,0) = (2*x*y)/((r0 - r1)*pow(pow(x,2) \
+ pow(y,2) + pow(z,2),1.5));\\n    dJ(2)(1,1) = (-2*(pow(x,2) + \
pow(z,2)))/((r0 - r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n    \
dJ(2)(1,2) = (2*y*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n  \
  dJ(2)(2,0) = (2*x*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) + \
pow(z,2),1.5));\\n    dJ(2)(2,1) = (2*y*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) \
+ pow(z,2),1.5));\\n    dJ(2)(2,2) = (-2*(pow(x,2) + pow(y,2)))/((r0 - \
r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n    break;\\n\"\>"], "Output",\

 CellChangeTimes->{
  3.967574454039349*^9, {3.967574523852476*^9, 3.967574539328891*^9}, 
   3.96757466425464*^9, 3.967574866296774*^9, 3.9675749209248333`*^9, 
   3.967574999781465*^9, 3.973079572742157*^9, 3.975268721962325*^9, 
   3.975268920173423*^9, 3.975294706728942*^9, 3.975294768563488*^9, 
   3.97529583164165*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"6efba46a-f01d-4441-b4d1-e910512cd122"],

Cell[BoxData["\<\"case PatchPiece::plus_y:\\n    J(0)(0) = 0;\\n    J(0)(1) = \
-(z/pow(y,2));\\n    J(0)(2) = 1/y;\\n    J(1)(0) = -(1/y);\\n    J(1)(1) = \
x/pow(y,2);\\n    J(1)(2) = 0;\\n    J(2)(0) = (-2*x)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n    J(2)(1) = (-2*y)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n    J(2)(2) = (-2*z)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n\\n    dJ(0)(0,0) = 0;\\n    \
dJ(0)(0,1) = 0;\\n    dJ(0)(0,2) = 0;\\n    dJ(0)(1,0) = 0;\\n    dJ(0)(1,1) \
= (2*z)/pow(y,3);\\n    dJ(0)(1,2) = -pow(y,-2);\\n    dJ(0)(2,0) = 0;\\n    \
dJ(0)(2,1) = -pow(y,-2);\\n    dJ(0)(2,2) = 0;\\n    dJ(1)(0,0) = 0;\\n    \
dJ(1)(0,1) = pow(y,-2);\\n    dJ(1)(0,2) = 0;\\n    dJ(1)(1,0) = \
pow(y,-2);\\n    dJ(1)(1,1) = (-2*x)/pow(y,3);\\n    dJ(1)(1,2) = 0;\\n    \
dJ(1)(2,0) = 0;\\n    dJ(1)(2,1) = 0;\\n    dJ(1)(2,2) = 0;\\n    dJ(2)(0,0) \
= (-2*(pow(y,2) + pow(z,2)))/((r0 - r1)*pow(pow(x,2) + pow(y,2) + \
pow(z,2),1.5));\\n    dJ(2)(0,1) = (2*x*y)/((r0 - r1)*pow(pow(x,2) + pow(y,2) \
+ pow(z,2),1.5));\\n    dJ(2)(0,2) = (2*x*z)/((r0 - r1)*pow(pow(x,2) + \
pow(y,2) + pow(z,2),1.5));\\n    dJ(2)(1,0) = (2*x*y)/((r0 - r1)*pow(pow(x,2) \
+ pow(y,2) + pow(z,2),1.5));\\n    dJ(2)(1,1) = (-2*(pow(x,2) + \
pow(z,2)))/((r0 - r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n    \
dJ(2)(1,2) = (2*y*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n  \
  dJ(2)(2,0) = (2*x*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) + \
pow(z,2),1.5));\\n    dJ(2)(2,1) = (2*y*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) \
+ pow(z,2),1.5));\\n    dJ(2)(2,2) = (-2*(pow(x,2) + pow(y,2)))/((r0 - \
r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n    break;\\n\"\>"], "Output",\

 CellChangeTimes->{
  3.967574454039349*^9, {3.967574523852476*^9, 3.967574539328891*^9}, 
   3.96757466425464*^9, 3.967574866296774*^9, 3.9675749209248333`*^9, 
   3.967574999781465*^9, 3.973079572742157*^9, 3.975268721962325*^9, 
   3.975268920173423*^9, 3.975294706728942*^9, 3.975294768563488*^9, 
   3.9752958316748123`*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"75b6656b-ec8f-4767-926b-7d01a9bfe03a"],

Cell[BoxData["\<\"case PatchPiece::minus_x:\\n    J(0)(0) = z/pow(x,2);\\n    \
J(0)(1) = 0;\\n    J(0)(2) = -(1/x);\\n    J(1)(0) = -(y/pow(x,2));\\n    \
J(1)(1) = 1/x;\\n    J(1)(2) = 0;\\n    J(2)(0) = (-2*x)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n    J(2)(1) = (-2*y)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n    J(2)(2) = (-2*z)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n\\n    dJ(0)(0,0) = \
(-2*z)/pow(x,3);\\n    dJ(0)(0,1) = 0;\\n    dJ(0)(0,2) = pow(x,-2);\\n    \
dJ(0)(1,0) = 0;\\n    dJ(0)(1,1) = 0;\\n    dJ(0)(1,2) = 0;\\n    dJ(0)(2,0) \
= pow(x,-2);\\n    dJ(0)(2,1) = 0;\\n    dJ(0)(2,2) = 0;\\n    dJ(1)(0,0) = \
(2*y)/pow(x,3);\\n    dJ(1)(0,1) = -pow(x,-2);\\n    dJ(1)(0,2) = 0;\\n    \
dJ(1)(1,0) = -pow(x,-2);\\n    dJ(1)(1,1) = 0;\\n    dJ(1)(1,2) = 0;\\n    \
dJ(1)(2,0) = 0;\\n    dJ(1)(2,1) = 0;\\n    dJ(1)(2,2) = 0;\\n    dJ(2)(0,0) \
= (-2*(pow(y,2) + pow(z,2)))/((r0 - r1)*pow(pow(x,2) + pow(y,2) + \
pow(z,2),1.5));\\n    dJ(2)(0,1) = (2*x*y)/((r0 - r1)*pow(pow(x,2) + pow(y,2) \
+ pow(z,2),1.5));\\n    dJ(2)(0,2) = (2*x*z)/((r0 - r1)*pow(pow(x,2) + \
pow(y,2) + pow(z,2),1.5));\\n    dJ(2)(1,0) = (2*x*y)/((r0 - r1)*pow(pow(x,2) \
+ pow(y,2) + pow(z,2),1.5));\\n    dJ(2)(1,1) = (-2*(pow(x,2) + \
pow(z,2)))/((r0 - r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n    \
dJ(2)(1,2) = (2*y*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n  \
  dJ(2)(2,0) = (2*x*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) + \
pow(z,2),1.5));\\n    dJ(2)(2,1) = (2*y*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) \
+ pow(z,2),1.5));\\n    dJ(2)(2,2) = (-2*(pow(x,2) + pow(y,2)))/((r0 - \
r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n    break;\\n\"\>"], "Output",\

 CellChangeTimes->{
  3.967574454039349*^9, {3.967574523852476*^9, 3.967574539328891*^9}, 
   3.96757466425464*^9, 3.967574866296774*^9, 3.9675749209248333`*^9, 
   3.967574999781465*^9, 3.973079572742157*^9, 3.975268721962325*^9, 
   3.975268920173423*^9, 3.975294706728942*^9, 3.975294768563488*^9, 
   3.975295831675812*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"4f30b56d-7350-4c30-a251-2b9ba9d15a2d"],

Cell[BoxData["\<\"case PatchPiece::minus_y:\\n    J(0)(0) = 0;\\n    J(0)(1) \
= z/pow(y,2);\\n    J(0)(2) = -(1/y);\\n    J(1)(0) = -(1/y);\\n    J(1)(1) = \
x/pow(y,2);\\n    J(1)(2) = 0;\\n    J(2)(0) = (-2*x)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n    J(2)(1) = (-2*y)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n    J(2)(2) = (-2*z)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n\\n    dJ(0)(0,0) = 0;\\n    \
dJ(0)(0,1) = 0;\\n    dJ(0)(0,2) = 0;\\n    dJ(0)(1,0) = 0;\\n    dJ(0)(1,1) \
= (-2*z)/pow(y,3);\\n    dJ(0)(1,2) = pow(y,-2);\\n    dJ(0)(2,0) = 0;\\n    \
dJ(0)(2,1) = pow(y,-2);\\n    dJ(0)(2,2) = 0;\\n    dJ(1)(0,0) = 0;\\n    \
dJ(1)(0,1) = pow(y,-2);\\n    dJ(1)(0,2) = 0;\\n    dJ(1)(1,0) = \
pow(y,-2);\\n    dJ(1)(1,1) = (-2*x)/pow(y,3);\\n    dJ(1)(1,2) = 0;\\n    \
dJ(1)(2,0) = 0;\\n    dJ(1)(2,1) = 0;\\n    dJ(1)(2,2) = 0;\\n    dJ(2)(0,0) \
= (-2*(pow(y,2) + pow(z,2)))/((r0 - r1)*pow(pow(x,2) + pow(y,2) + \
pow(z,2),1.5));\\n    dJ(2)(0,1) = (2*x*y)/((r0 - r1)*pow(pow(x,2) + pow(y,2) \
+ pow(z,2),1.5));\\n    dJ(2)(0,2) = (2*x*z)/((r0 - r1)*pow(pow(x,2) + \
pow(y,2) + pow(z,2),1.5));\\n    dJ(2)(1,0) = (2*x*y)/((r0 - r1)*pow(pow(x,2) \
+ pow(y,2) + pow(z,2),1.5));\\n    dJ(2)(1,1) = (-2*(pow(x,2) + \
pow(z,2)))/((r0 - r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n    \
dJ(2)(1,2) = (2*y*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n  \
  dJ(2)(2,0) = (2*x*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) + \
pow(z,2),1.5));\\n    dJ(2)(2,1) = (2*y*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) \
+ pow(z,2),1.5));\\n    dJ(2)(2,2) = (-2*(pow(x,2) + pow(y,2)))/((r0 - \
r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n    break;\\n\"\>"], "Output",\

 CellChangeTimes->{
  3.967574454039349*^9, {3.967574523852476*^9, 3.967574539328891*^9}, 
   3.96757466425464*^9, 3.967574866296774*^9, 3.9675749209248333`*^9, 
   3.967574999781465*^9, 3.973079572742157*^9, 3.975268721962325*^9, 
   3.975268920173423*^9, 3.975294706728942*^9, 3.975294768563488*^9, 
   3.975295831676791*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"30d09180-a7b8-4809-b122-e0154b6c8da5"],

Cell[BoxData["\<\"case PatchPiece::plus_z:\\n    J(0)(0) = -(1/z);\\n    \
J(0)(1) = 0;\\n    J(0)(2) = x/pow(z,2);\\n    J(1)(0) = 0;\\n    J(1)(1) = \
1/z;\\n    J(1)(2) = -(y/pow(z,2));\\n    J(2)(0) = (-2*x)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n    J(2)(1) = (-2*y)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n    J(2)(2) = (-2*z)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n\\n    dJ(0)(0,0) = 0;\\n    \
dJ(0)(0,1) = 0;\\n    dJ(0)(0,2) = pow(z,-2);\\n    dJ(0)(1,0) = 0;\\n    \
dJ(0)(1,1) = 0;\\n    dJ(0)(1,2) = 0;\\n    dJ(0)(2,0) = pow(z,-2);\\n    \
dJ(0)(2,1) = 0;\\n    dJ(0)(2,2) = (-2*x)/pow(z,3);\\n    dJ(1)(0,0) = 0;\\n  \
  dJ(1)(0,1) = 0;\\n    dJ(1)(0,2) = 0;\\n    dJ(1)(1,0) = 0;\\n    \
dJ(1)(1,1) = 0;\\n    dJ(1)(1,2) = -pow(z,-2);\\n    dJ(1)(2,0) = 0;\\n    \
dJ(1)(2,1) = -pow(z,-2);\\n    dJ(1)(2,2) = (2*y)/pow(z,3);\\n    dJ(2)(0,0) \
= (-2*(pow(y,2) + pow(z,2)))/((r0 - r1)*pow(pow(x,2) + pow(y,2) + \
pow(z,2),1.5));\\n    dJ(2)(0,1) = (2*x*y)/((r0 - r1)*pow(pow(x,2) + pow(y,2) \
+ pow(z,2),1.5));\\n    dJ(2)(0,2) = (2*x*z)/((r0 - r1)*pow(pow(x,2) + \
pow(y,2) + pow(z,2),1.5));\\n    dJ(2)(1,0) = (2*x*y)/((r0 - r1)*pow(pow(x,2) \
+ pow(y,2) + pow(z,2),1.5));\\n    dJ(2)(1,1) = (-2*(pow(x,2) + \
pow(z,2)))/((r0 - r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n    \
dJ(2)(1,2) = (2*y*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n  \
  dJ(2)(2,0) = (2*x*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) + \
pow(z,2),1.5));\\n    dJ(2)(2,1) = (2*y*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) \
+ pow(z,2),1.5));\\n    dJ(2)(2,2) = (-2*(pow(x,2) + pow(y,2)))/((r0 - \
r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n    break;\\n\"\>"], "Output",\

 CellChangeTimes->{
  3.967574454039349*^9, {3.967574523852476*^9, 3.967574539328891*^9}, 
   3.96757466425464*^9, 3.967574866296774*^9, 3.9675749209248333`*^9, 
   3.967574999781465*^9, 3.973079572742157*^9, 3.975268721962325*^9, 
   3.975268920173423*^9, 3.975294706728942*^9, 3.975294768563488*^9, 
   3.975295831677712*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"9b9c0603-4a5e-4651-b16f-e1ddd81c5bf8"],

Cell[BoxData["\<\"case PatchPiece::minus_z:\\n    J(0)(0) = -(1/z);\\n    \
J(0)(1) = 0;\\n    J(0)(2) = x/pow(z,2);\\n    J(1)(0) = 0;\\n    J(1)(1) = \
-(1/z);\\n    J(1)(2) = y/pow(z,2);\\n    J(2)(0) = (-2*x)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n    J(2)(1) = (-2*y)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n    J(2)(2) = (-2*z)/((r0 - \
r1)*sqrt(pow(x,2) + pow(y,2) + pow(z,2)));\\n\\n    dJ(0)(0,0) = 0;\\n    \
dJ(0)(0,1) = 0;\\n    dJ(0)(0,2) = pow(z,-2);\\n    dJ(0)(1,0) = 0;\\n    \
dJ(0)(1,1) = 0;\\n    dJ(0)(1,2) = 0;\\n    dJ(0)(2,0) = pow(z,-2);\\n    \
dJ(0)(2,1) = 0;\\n    dJ(0)(2,2) = (-2*x)/pow(z,3);\\n    dJ(1)(0,0) = 0;\\n  \
  dJ(1)(0,1) = 0;\\n    dJ(1)(0,2) = 0;\\n    dJ(1)(1,0) = 0;\\n    \
dJ(1)(1,1) = 0;\\n    dJ(1)(1,2) = pow(z,-2);\\n    dJ(1)(2,0) = 0;\\n    \
dJ(1)(2,1) = pow(z,-2);\\n    dJ(1)(2,2) = (-2*y)/pow(z,3);\\n    dJ(2)(0,0) \
= (-2*(pow(y,2) + pow(z,2)))/((r0 - r1)*pow(pow(x,2) + pow(y,2) + \
pow(z,2),1.5));\\n    dJ(2)(0,1) = (2*x*y)/((r0 - r1)*pow(pow(x,2) + pow(y,2) \
+ pow(z,2),1.5));\\n    dJ(2)(0,2) = (2*x*z)/((r0 - r1)*pow(pow(x,2) + \
pow(y,2) + pow(z,2),1.5));\\n    dJ(2)(1,0) = (2*x*y)/((r0 - r1)*pow(pow(x,2) \
+ pow(y,2) + pow(z,2),1.5));\\n    dJ(2)(1,1) = (-2*(pow(x,2) + \
pow(z,2)))/((r0 - r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n    \
dJ(2)(1,2) = (2*y*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n  \
  dJ(2)(2,0) = (2*x*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) + \
pow(z,2),1.5));\\n    dJ(2)(2,1) = (2*y*z)/((r0 - r1)*pow(pow(x,2) + pow(y,2) \
+ pow(z,2),1.5));\\n    dJ(2)(2,2) = (-2*(pow(x,2) + pow(y,2)))/((r0 - \
r1)*pow(pow(x,2) + pow(y,2) + pow(z,2),1.5));\\n    break;\\n\"\>"], "Output",\

 CellChangeTimes->{
  3.967574454039349*^9, {3.967574523852476*^9, 3.967574539328891*^9}, 
   3.96757466425464*^9, 3.967574866296774*^9, 3.9675749209248333`*^9, 
   3.967574999781465*^9, 3.973079572742157*^9, 3.975268721962325*^9, 
   3.975268920173423*^9, 3.975294706728942*^9, 3.975294768563488*^9, 
   3.975295831678687*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"6544d2df-bec0-4bcf-8fa9-3290d24f734f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 756},
WindowMargins->{{1097.25, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
DefaultNaturalLanguage->Language,
FrontEndVersion->"14.2 for Linux x86 (64-bit) (December 26, 2024)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"c7c54479-860f-4a9a-bc66-0ea79160d210"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 476, 7, 95, "Title",ExpressionUUID->"06cf51ac-2049-45e5-befb-5e7a3ea14fb4"],
Cell[CellGroupData[{
Cell[1081, 33, 154, 3, 67, "Section",ExpressionUUID->"c6457ca3-1714-4873-8939-acf5ec5341ca"],
Cell[1238, 38, 1783, 51, 153, "Input",ExpressionUUID->"f9245ca4-e8e9-41b0-ba49-02ff0b656537"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3058, 94, 352, 6, 67, "Section",ExpressionUUID->"4433c9f4-e92e-44f9-a920-9fcf114e462f"],
Cell[3413, 102, 460, 9, 41, "Input",ExpressionUUID->"e02718e7-d42d-49ab-aad7-206b2a63f45a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3910, 116, 211, 4, 67, "Section",ExpressionUUID->"c15fe3d2-3cf8-46ee-8721-be7399087296"],
Cell[CellGroupData[{
Cell[4146, 124, 6365, 166, 789, "Input",ExpressionUUID->"45564e3e-4a33-437b-ad14-76faf69b5efd"],
Cell[CellGroupData[{
Cell[10536, 294, 587, 10, 23, "Print",ExpressionUUID->"911f1ab4-afb7-48db-9700-e5b83ddc528d"],
Cell[11126, 306, 877, 18, 23, "Print",ExpressionUUID->"01b3b217-0f8a-46d8-a240-53d30495e969"],
Cell[12006, 326, 885, 18, 23, "Print",ExpressionUUID->"18269213-84ff-4a63-a9b5-6d0d1d63189a"],
Cell[12894, 346, 884, 18, 23, "Print",ExpressionUUID->"3d32dc03-7507-491d-88b6-c8fd0d645387"],
Cell[13781, 366, 570, 10, 41, "Print",ExpressionUUID->"ca5264d5-7544-40e4-a926-c21f1409ab4e"],
Cell[14354, 378, 585, 10, 23, "Print",ExpressionUUID->"33496879-5edd-42bd-bc24-2cf887b4668b"],
Cell[14942, 390, 891, 18, 23, "Print",ExpressionUUID->"a02f2cbd-254b-4acf-b8bd-a7e8c1491574"],
Cell[15836, 410, 879, 18, 23, "Print",ExpressionUUID->"d3c16b13-67d7-4016-bca5-196338fea98e"],
Cell[16718, 430, 887, 18, 23, "Print",ExpressionUUID->"70574269-d600-4c2f-b093-9c31389ab77d"],
Cell[17608, 450, 569, 10, 41, "Print",ExpressionUUID->"2d781cbb-42a8-472b-ac01-fcfcf2281ba6"],
Cell[18180, 462, 588, 10, 23, "Print",ExpressionUUID->"8d1ac5aa-28e7-4897-871b-58de9726c568"],
Cell[18771, 474, 883, 18, 23, "Print",ExpressionUUID->"4fa3e576-d9c8-4535-ad59-f0e6af7cb9e2"],
Cell[19657, 494, 891, 18, 23, "Print",ExpressionUUID->"0d872fad-9875-4eb2-9a41-60dd0a1f3907"],
Cell[20551, 514, 885, 18, 23, "Print",ExpressionUUID->"cee1d722-49e9-4b7c-8057-a84d157e244a"],
Cell[21439, 534, 572, 10, 41, "Print",ExpressionUUID->"14c53ad7-cebf-4343-97fe-70788f0ad76d"],
Cell[22014, 546, 588, 10, 23, "Print",ExpressionUUID->"3289080d-45c0-4392-a612-d26541f8a84a"],
Cell[22605, 558, 887, 18, 23, "Print",ExpressionUUID->"fbe71d81-65c8-4a89-a062-cd506184473b"],
Cell[23495, 578, 883, 18, 23, "Print",ExpressionUUID->"b8a42c52-33d4-4fb4-9617-051c3a0819ec"],
Cell[24381, 598, 887, 18, 23, "Print",ExpressionUUID->"52ae0f51-d654-4f28-ada5-8a076e263736"],
Cell[25271, 618, 570, 10, 41, "Print",ExpressionUUID->"6049124b-8156-45f3-aab2-734f6c522005"],
Cell[25844, 630, 587, 10, 23, "Print",ExpressionUUID->"708b3bb1-ea5e-491a-a005-355751ec73f9"],
Cell[26434, 642, 893, 18, 23, "Print",ExpressionUUID->"e971f7bf-bf5d-4b62-94d6-b45a88ef4d67"],
Cell[27330, 662, 887, 18, 23, "Print",ExpressionUUID->"5d2aae18-4ddd-4422-8501-710a701a0689"],
Cell[28220, 682, 879, 18, 23, "Print",ExpressionUUID->"5fa13286-2eec-4411-adca-a83956e51c2f"],
Cell[29102, 702, 572, 10, 41, "Print",ExpressionUUID->"bf39f06f-d681-4416-b71c-14c689d95442"],
Cell[29677, 714, 586, 10, 23, "Print",ExpressionUUID->"7a1e7cac-93f4-49f8-b632-3af1c284ed65"],
Cell[30266, 726, 887, 18, 23, "Print",ExpressionUUID->"a60d3176-33ef-4069-a066-93b447a60b02"],
Cell[31156, 746, 885, 18, 23, "Print",ExpressionUUID->"4dfe2d5b-0b7d-436c-942e-dd06ff009ef0"],
Cell[32044, 766, 883, 18, 23, "Print",ExpressionUUID->"c9dbc117-f080-42d5-a7a1-38d4d48429d6"],
Cell[32930, 786, 570, 10, 41, "Print",ExpressionUUID->"54ecd846-5d07-4dce-8857-ea075ac4f479"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33561, 803, 257, 4, 67, "Section",ExpressionUUID->"fe49fa3d-90d5-4db5-99a9-4384ecdef012"],
Cell[CellGroupData[{
Cell[33843, 811, 6464, 167, 789, "Input",ExpressionUUID->"773c85fb-2342-4844-9b40-46ebe84a1bb4"],
Cell[CellGroupData[{
Cell[40332, 982, 689, 11, 23, "Print",ExpressionUUID->"f9afc488-1de6-45a7-a3eb-988b8c31c414"],
Cell[41024, 995, 860, 16, 23, "Print",ExpressionUUID->"5a8fdcb7-33b0-4fc0-b8d4-674ac8b26378"],
Cell[41887, 1013, 860, 16, 23, "Print",ExpressionUUID->"77b9075a-f793-4dc9-8b0b-e712b1d51b68"],
Cell[42750, 1031, 983, 19, 23, "Print",ExpressionUUID->"b961cd29-9fab-4d1c-ae8b-d799d07d4700"],
Cell[43736, 1052, 676, 11, 41, "Print",ExpressionUUID->"70f80eee-5045-4c42-8da9-13e75fb51685"],
Cell[44415, 1065, 691, 11, 23, "Print",ExpressionUUID->"692fce85-23fb-4036-a9b9-d2148a934f69"],
Cell[45109, 1078, 860, 16, 23, "Print",ExpressionUUID->"32129238-54bd-49e7-91aa-257fd4eb461f"],
Cell[45972, 1096, 866, 16, 23, "Print",ExpressionUUID->"1ac5a99b-6168-495b-b825-013d08092f11"],
Cell[46841, 1114, 985, 19, 23, "Print",ExpressionUUID->"0ed6781b-e3d6-4c61-9331-28e320c72283"],
Cell[47829, 1135, 674, 11, 41, "Print",ExpressionUUID->"669673a6-1b99-4a81-86e4-8e9ca24460d5"],
Cell[48506, 1148, 690, 11, 23, "Print",ExpressionUUID->"12b3ea1e-1478-4150-ada1-22c5aa31a92e"],
Cell[49199, 1161, 866, 16, 23, "Print",ExpressionUUID->"6ba9cf5c-841e-4c5b-8c6a-0062dfc8ccda"],
Cell[50068, 1179, 860, 16, 23, "Print",ExpressionUUID->"af454a7d-bad8-49b0-aa26-1df79c94dfae"],
Cell[50931, 1197, 985, 19, 23, "Print",ExpressionUUID->"5050a22d-9b33-4ff2-9ca6-44f62d23d7b2"],
Cell[51919, 1218, 674, 11, 41, "Print",ExpressionUUID->"975baffe-e0b4-457e-9c1c-b81e6677a72a"],
Cell[52596, 1231, 690, 11, 23, "Print",ExpressionUUID->"69249e88-c95c-476e-953d-d10260672d30"],
Cell[53289, 1244, 868, 16, 23, "Print",ExpressionUUID->"e4cc5a37-376d-40bf-92ff-6527f5256894"],
Cell[54160, 1262, 866, 16, 23, "Print",ExpressionUUID->"5dc542e3-ebd6-42fb-842e-4a0ff5aee12d"],
Cell[55029, 1280, 985, 19, 23, "Print",ExpressionUUID->"c0d25e85-8340-470c-90f5-f5f109f02be3"],
Cell[56017, 1301, 676, 11, 41, "Print",ExpressionUUID->"eea7e465-3381-4a1b-a11e-fc075860401b"],
Cell[56696, 1314, 689, 11, 23, "Print",ExpressionUUID->"d86bbd0a-6c5f-45f1-9946-ab038d651873"],
Cell[57388, 1327, 866, 16, 23, "Print",ExpressionUUID->"c0fcf53a-0a1d-4f03-bd3f-aef22dbdfe17"],
Cell[58257, 1345, 860, 16, 23, "Print",ExpressionUUID->"ab055b7f-8724-45b5-972d-3f3f8a47005a"],
Cell[59120, 1363, 983, 19, 23, "Print",ExpressionUUID->"a38f13fa-ac42-4055-8b46-6332ee14a2f0"],
Cell[60106, 1384, 676, 11, 41, "Print",ExpressionUUID->"6761da85-4bd8-47e0-bfee-6507f596a213"],
Cell[60785, 1397, 690, 11, 23, "Print",ExpressionUUID->"1b8f5fd9-9505-4a4a-81cb-73dedadc5fec"],
Cell[61478, 1410, 866, 16, 23, "Print",ExpressionUUID->"364ac97f-7e40-40d7-bfca-8ecb96689cbd"],
Cell[62347, 1428, 866, 16, 23, "Print",ExpressionUUID->"3599eaf7-1616-4dd3-a4fa-4c793231959c"],
Cell[63216, 1446, 985, 19, 23, "Print",ExpressionUUID->"7d08114b-12d1-412c-8833-fc209c9884aa"],
Cell[64204, 1467, 676, 11, 41, "Print",ExpressionUUID->"65c3aa45-a64b-475b-96fa-263c1969d882"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64941, 1485, 298, 5, 67, "Section",ExpressionUUID->"d9a6ec80-94ff-4010-a85e-5a76d9141abd"],
Cell[65242, 1492, 1247, 32, 113, "Text",ExpressionUUID->"a1dc3eef-aba1-46f5-8810-b875ef843746"],
Cell[66492, 1526, 4286, 93, 512, "Input",ExpressionUUID->"24dd430f-c257-4863-b47f-f7d4a552d3d2"],
Cell[CellGroupData[{
Cell[70803, 1623, 999, 17, 153, "Input",ExpressionUUID->"fda5be34-f34c-4f40-9347-29d6d330f1cc"],
Cell[71805, 1642, 2126, 30, 821, "Output",ExpressionUUID->"6efba46a-f01d-4441-b4d1-e910512cd122"],
Cell[73934, 1674, 2128, 30, 821, "Output",ExpressionUUID->"75b6656b-ec8f-4767-926b-7d01a9bfe03a"],
Cell[76065, 1706, 2127, 30, 821, "Output",ExpressionUUID->"4f30b56d-7350-4c30-a251-2b9ba9d15a2d"],
Cell[78195, 1738, 2126, 30, 821, "Output",ExpressionUUID->"30d09180-a7b8-4809-b122-e0154b6c8da5"],
Cell[80324, 1770, 2126, 30, 821, "Output",ExpressionUUID->"9b9c0603-4a5e-4651-b16f-e1ddd81c5bf8"],
Cell[82453, 1802, 2126, 30, 821, "Output",ExpressionUUID->"6544d2df-bec0-4bcf-8fa9-3290d24f734f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

